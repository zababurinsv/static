import store from"/static/html/components/component_modules/staticProperty/staticProperty.mjs";import matcher from"/static/html/components/component_modules/matcher/matcher.mjs";import action from"/static/html/components/component_modules/action/action.mjs";import staticProperty from"/static/html/components/component_modules/staticProperty/staticProperty.mjs";import addEventListener from"/static/html/components/component_modules/addEventListener/addEventListener.mjs";(async()=>{bundle.default({input:"object"},null,async function(e,t){for(let e=0;e<t.store["lacerta-moderator"].length;e++)switch(t.store["lacerta-moderator"][e].slot){case"moderator-admin":t.store["lacerta-moderator"][e].img=t.store["lacerta-moderator"][e].this.shadowRoot.querySelector(".moderator"),await staticProperty({input:"lacerta-moderator",type:"store",store:t.store["lacerta-moderator"]},"set","type"),t.store["lacerta-moderator"][e].this.shadowRoot.querySelector("#image").onchange=function(r){let o=new CustomEvent("sideBarCrop",{detail:{id:"lacerta-moderator",slot:t.store["lacerta-moderator"][e].slot,file:r.target.files[0]}});document.dispatchEvent(o),r.target.value=""};break;case"lacerta-moderator":let r=await matcher.webdav({input:"varan-moderator",type:"list",data:{type:"moderator"},path:"/list"},"post","type");if(0===r.length);else{t.store["lacerta-moderator"][e].this.shadowRoot.querySelector(".main").innerHTML="";for(let o=0;o<r.length;o++){t.store["lacerta-moderator"][e].this.shadowRoot.querySelector(".main").insertAdjacentHTML("beforeend",r[o]);let a=t.store["lacerta-moderator"][e].this.shadowRoot.querySelector(`.item_${o}`),n=a.querySelector(".timestamp").innerText;n=+n,a.addEventListener("click",e=>{"/admin"===window.location.pathname||"/admin/"===window.location.pathname||"P"===e.target.tagName&&"SUMMARY"===e.target.parentNode.tagName||"SPAN"===e.target.tagName&&"P"===e.target.parentNode.tagName&&"SUMMARY"===e.target.parentNode.parentNode.tagName||"EM"===e.target.tagName&&"P"===e.target.parentNode.tagName||(e.preventDefault(),e.target.open=!1)}),a.querySelector(".delete").addEventListener("click",async e=>{let r=e.target,o=!1;for(;!o;)"DETAILS"===r.tagName&&r.className.indexOf("item")>-1?o=!0:r=r.parentNode;let a=r.querySelector(".timestamp").innerText;a=+a,await action({input:"lacerta-moderator",this:t.store["lacerta-moderator"][0].this,date:a,remove:r,type:"moderator"},"delete","type"),r.remove()}),a.querySelector(".change").addEventListener("click",async e=>{let r=e.target,o=!1;for(;!o;)"DETAILS"===r.tagName&&r.className.indexOf("item")>-1?o=!0:r=r.parentNode;let a=r.querySelector(".timestamp").innerText;a=+a;let n=await staticProperty({input:"action",type:"all"},"get","type");e.target.innerText="данные добавляются в редактор",e.target.disabled=!0;for(let e=0;e<n["varan-editor"].length;e++)switch(n["varan-editor"][e].slot){case"moderator":n["varan-editor"][e].obj.this.querySelector(".wall").innerHTML="",n["varan-editor"][e].obj.this.querySelector(".wall").insertAdjacentHTML("afterbegin",r.querySelector(".preview").innerHTML),n["varan-editor"][e].editor.quill.root.innerHTML="",n["varan-editor"][e].editor.quill.root.innerHTML=r.querySelector(".preview").innerHTML;let t={},o={};t=null===n["varan-editor"][e].obj.this.querySelector(".menu-convert")?(t=n["varan-editor"][e].obj.this.querySelector("varan-menu")).shadowRoot.querySelector(".menu-convert"):n["varan-editor"][e].obj.this.querySelector(".menu-convert"),null!==(o=null===n["varan-editor"][e].obj.this.querySelector(".update")?(o=n["varan-editor"][e].obj.this.querySelector("varan-menu")).shadowRoot.querySelector(".update"):n["varan-editor"][e].obj.this.querySelector(".update"))&&o.remove(),t.insertAdjacentHTML("afterend",'<button class="update" type="button">update</button>'),o=null===n["varan-editor"][e].obj.this.querySelector(".update")?(o=n["varan-editor"][e].obj.this.querySelector("varan-menu")).shadowRoot.querySelector(".update"):n["varan-editor"][e].obj.this.querySelector(".update"),addEventListener({input:"lacerta-moderator",type:"menu-update",data:o},"add","type");break;case"moderatorContent":n["varan-editor"][e].obj.this.querySelector(".wall").innerHTML="",n["varan-editor"][e].obj.this.querySelector(".wall").insertAdjacentHTML("afterbegin",r.querySelector(".content").innerHTML),n["varan-editor"][e].obj.this.querySelector(".ql-editor").innerHTML=r.querySelector(".content").innerHTML;let a={},i={};(a=null===n["varan-editor"][e].obj.this.querySelector(".menu-convert")?(a=n["varan-editor"][e].obj.this.querySelector("varan-menu")).shadowRoot.querySelector(".menu-convert"):n["varan-editor"][e].obj.this.querySelector(".menu-convert")).insertAdjacentHTML("afterend",'<button class="update" type="button">update</button>'),i=null===n["varan-editor"][e].obj.this.querySelector(".update")?(i=n["varan-editor"][e].obj.this.querySelector("varan-menu")).shadowRoot.querySelector(".update"):n["varan-editor"][e].obj.this.querySelector(".update"),addEventListener({input:"lacerta-moderator",type:"menu-update",data:i},"add","type")}for(let e=0;e<t.store["lacerta-moderator"].length;e++)switch(t.store["lacerta-moderator"][e].slot){case"moderator-admin":t.store["lacerta-moderator"][e].obj.this.shadowRoot.querySelector(".timestamp").innerText=r.querySelector(".timestamp").innerText,t.store["lacerta-moderator"][e].obj.this.shadowRoot.querySelector("#titleItem").value=r.querySelector("h2").innerText,t.store["lacerta-moderator"][e].obj.this.shadowRoot.querySelector(".moderator").src=r.querySelector(".moderator").src}e.target.innerText="данные в редакторе",setTimeout(()=>{obj.button.innerText="изменить",obj.button.disabled=!1},2e3)})}}}})})();