import matcher from"/static/html/components/component_modules/matcher/matcher.mjs";import pagination from"/static/html/components/component_modules/varan-pagination/varan-pagination.mjs";function colorLog(e,t,...l){switch(t=t||"black"){case"success":t="Green";break;case"info":t="DodgerBlue";break;case"error":t="Red";break;case"warning":t="Orange";break;case"events-out":t="blue";break;case"violet":t="violet"}console.log("%c"+e,"color:"+t,...l)}let slider={};function setSlider(e){return new Promise(function(t,l){e.slider=Peppermint(e.this.querySelector(".peppermint"),{dots:!1,slideshow:!1,speed:500,slideshowInterval:5e3,stopSlideshowAfterInteraction:!0,onSetup:function(t){e.slider.recalcWidth(),console.log("Peppermint setup done. Slides found: "+t)}}),t(e)})}Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,l=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&l.push(t);return l}),slider.addItem=function(e){return new Promise(function(t,l){let n={},r={};if(r=void 0===e.slider.getSlidesNumber()?0:e.slider.getSlidesNumber()-1,colorLog("~~~~~~~~editor.addItem~~~~~~~~","success",e.this.querySelector(".ql-view")),e.this.querySelector(".ql-view")){let t=document.createElement("section");t.className="slider",t.slot="view";let l=document.createElement("div");l.className="peppermint";for(let n=0;n<2;n++){let r=document.createElement("section");r.className="ql-editor "+`${e.slot}`,0===n&&(r.innerHTML=e["slider-template"].querySelector(".ql-view").innerHTML),r.setAttribute("page",n+1),l.appendChild(r),t.appendChild(l)}n=t.querySelector(".peppermint").children.length-1,e["slider-template"].innerHTML="",e["slider-template"].innerHTML=t.innerHTML,e.slider=Peppermint(e["slider-template"].querySelector(".peppermint"),{dots:!1,slideshow:!1,speed:500,startSlide:r,slideshowInterval:5e3,stopSlideshowAfterInteraction:!0,onSetup:function(t){e.slider.recalcWidth(),colorLog(`<varan-slider>  ${e}`,"success","Slides found: "+t)}}),e.upload={},e.upload["view-slider-pos"]=n,matcher.database.request.functions.setImages(e).then(e=>{e.this.querySelector(".menu-delete").style.background="#ccc",e.this.querySelector(".menu-delete").disabled=!1,e.this.querySelector(".menu-delete").color="black"})}else{let t=document.createElement("section");t.className="slider",t.slot="view";let l=document.createElement("div");l.className="peppermint";let i=e.this.querySelector(".peppermint-slides").children.length,o=0;n=i;for(let n=0;n<i+1;n++){let r=document.createElement("section");r.className="ql-editor "+`${e.slot}`,o<i&&(r.innerHTML=e.this.querySelector(".peppermint-slides").children[n].innerHTML,o++),r.setAttribute("page",n+1),l.appendChild(r),t.appendChild(l)}e["slider-template"].innerHTML="",e["slider-template"].innerHTML=t.innerHTML,e.slider=Peppermint(e["slider-template"].querySelector(".peppermint"),{dots:!1,slideshow:!1,speed:500,startSlide:r,slideshowInterval:5e3,stopSlideshowAfterInteraction:!0,onSetup:function(t){e.slider.recalcWidth(),console.log("Peppermint setup done. Slides found: "+t)}}),e.upload={},e.upload["view-slider-pos"]=n,colorLog("~~~~~~~~~~~<slide-upload>~~~~~~~~~~~","#9370DB",e.upload),matcher.database.request.functions.setImages(e).then(e=>{})}})},slider.delItem=function(e){return new Promise(function(t,l){e.this.querySelector(".ql-view")||matcher.database.request.functions.getObject(e).then(e=>{let l={},n=e.slider.getCurrentPos(),r=e.slider.getSlidesNumber()-1,i=[];l=e.slot?e.slot:e.parent;for(let t=0;t<e.get_n.length;t++)i.push(e.get_n[t][l]["view-slider-pos"]);i.sort(function(e,t){return e-t});let o=i[`${n}`];for(let t=0;t<e.get_n.length;t++)+o===e.get_n[t][l]["view-slider-pos"]&&(e.delete=e.get_n.splice(t,1)[0]);let s=[];for(let t=0;t<e.get_n.length;t++)s.push(e.get_n[t][l]["view-slider-pos"]);s.sort(function(e,t){return e-t});let d=document.createElement("section");d.className="slider",d.slot="view";let c=document.createElement("div");c.className="peppermint";for(let t=0;t<r;t++){let n=document.createElement("section");1===r?(e.this.querySelector(".menu-delete").style.background="#000000",n.className="ql-editor "+`${e.slot} ql-view`):(e.this.querySelector(".menu-delete").style.background="#ccc",n.innerHTML=" ",n.className="ql-editor "+`${e.slot}`),n.setAttribute("page",t+1);for(let r=0;r<e.get_n.length;r++)s[t]===e.get_n[r][l]["view-slider-pos"]&&(n.innerHTML=e.get_n[r][l].content);c.appendChild(n),d.appendChild(c)}let a=0;0!==n&&(a=n-1);for(let t=0;t<e.get_n.length;t++)for(let n=0;n<s.length;n++)if(s[n]===e.get_n[t][l]["view-slider-pos"]){let n=document.createElement("p");n.innerHTML=e.get_n[t][l].content,e.editor.queue[l].this.quill.setText(n.innerText)}e.get_n=null,e.get=null,matcher.database.request.functions.delImages(e).then(e=>{e["slider-template"].innerHTML="",e["slider-template"].innerHTML=d.innerHTML,e.slider=Peppermint(e["slider-template"].querySelector(".peppermint"),{dots:!1,slideshow:!1,startSlide:a,speed:500,slideshowInterval:5e3,stopSlideshowAfterInteraction:!0,onSetup:function(t){e.slider.recalcWidth(),console.log("Slides found: "+t)}}),t(e)})})})},slider.set=function(e){return new Promise(function(t,l){colorLog(`${e}<mathcer-in>matcher['database']['request']['functions']['getObject'](obj)</mathcer-in>`,"red",e.slider),colorLog(`<->editor.pagination['init']  ${e}`,"blueviolet",e.get),pagination.init(e),pagination.action(e).then(e=>{e.slider&&(colorLog(`<0>editor.pagination['init']  ${e}`,"blueviolet",e.pagination.listing_table),colorLog(`<0>  ${e}`,"blueviolet",e["slider-template"]),t(e),console.assert(!0,e.pagination.listing_table)),colorLog(`${e}<mathcer-out>editor.slider['set']</mathcer-out>`,"red",e.get)})}).catch(e=>e)};export default{addItem:e=>slider.addItem(e),delItem:e=>slider.delItem(e),set:e=>slider.set(e)};