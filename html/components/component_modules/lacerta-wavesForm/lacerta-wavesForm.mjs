var wave_json,wave_uri="http://public.jm3.net/d3/geiger.json",max_points=1024,width=880,height=140;function div_render(t,e){var a=d3.scale.linear().range([height,-height]),n=d3.scale.linear().domain([0,t.length]),r=d3.max(t,function(t){return t});a.domain([-r,r]);var i=width/t.length;d3.select(e).selectAll("div").data(wave_json).enter().append("div").attr("class","bar").style("width",i+"px").style("height",function(t,e){return a(t)+"px"}).style("bottom",function(t){return height-Math.abs(a(t)/2)-height/2+2+"px"}).style("left",function(t,e){return n(e)*width+"px"});var h=d3.svg.axis().scale(a).ticks(12).orient("left");d3.select(".waveform > div").append("svg").attr("class","axis").attr("width",60).attr("height",height).append("g").attr("transform","translate(40,"+height/2+")").call(h)}function svg_render(t,e){var a=d3.select(e).append("svg").attr("class","chart").attr("width",width).attr("height",height),n=d3.scale.linear().range([height,-height]),r=d3.max(t,function(t){return t});n.domain([-r,r]);d3.scale.linear().domain([0,t.length]);var i=width/t.length;a.attr("width",width).attr("height",height).selectAll("g").data(t).enter().append("g").attr("transform",function(t,e){return"translate("+e*i+",0)"}).append("rect").attr("y",function(t){return height-Math.abs(n(t)/2)-height/2+2}).attr("height",function(t){return Math.abs(n(t))}).attr("width",i);var h=d3.svg.axis().scale(n).ticks(12).orient("left");d3.select(".svg").append("svg").attr("class","axis").attr("width",60).attr("height",height).append("g").attr("transform","translate(40,"+height/2+")").call(h)}function d(t){console.log("log: "+t)}d3.json(wave_uri,function(t,e){div_render(wave_json=e.data.slice(1,max_points),".waveform >  div"),svg_render(wave_json,".waveform > .svg")});