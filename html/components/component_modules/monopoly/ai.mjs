import square from"./square.mjs";import gamePlay from"./gameplay.mjs";import mInterface from"./interface.mjs";let AI=[];AI.staticProperty=[],AI.staticProperty.count=0;export default{get:(e,r,...a)=>new Promise((t,o)=>{function n(e){t(e)}switch(e.type){case"AITest":(async(e,r,a)=>{try{e.player.AI={},e.player.AI.alertList="",AI.staticProperty.count++,e.player.name="AI Test "+AI.staticProperty.count,n(r)}catch(e){}})(e,r,...a);break;case"buyProperty":(async(e,r,a)=>{try{console.log("buyProperty");let e=square[index];p.money,e.price}catch(e){}})(e,r,...a);break;case"acceptTrade":(async(e,r,a)=>{try{console.log("acceptTrade");let e=0,r=tradeObj.getMoney(),a=tradeObj.getInitiator(),n=tradeObj.getRecipient(),c=[];e+=10*tradeObj.getCommunityChestJailCard(),e+=10*tradeObj.getChanceJailCard(),e+=r;for(var t=0;t<40;t++)c[t]=tradeObj.getProperty(t),e+=tradeObj.getProperty(t)*square[t].price*(square[t].mortgage?.5:1);console.log(e);var o=25-e+r;if(e>25)return!0;if(e>=-50&&a.money>o)new Trade(a,n,o,c,tradeObj.getCommunityChestJailCard(),tradeObj.getChanceJailCard())}catch(e){}})(e,r,...a);break;case"beforeTurn":(async(e,r,a)=>{let t,o,c,i,s,y=e.player;for(let e=0;e<40;e++)if((t=r.square[e]).owner===y.index&&t.groupNumber>=3){c=t.group.length,console.log(t),o=!0,s=6;for(let e=c-1;e>=0;e--){if(r.square[t.group[e]].owner!==y.index){o=!1;break}square[t.group[e]].house<s&&(s=(i=r.square[t.group[e]]).house)}if(!o)continue;y.money>i.houseprice+100&&buyHouse(i.index)}for(var l=39;l>=0;l--)(t=r.square[l]).owner===y.index&&t.mortgage&&y.money>t.price&&await mInterface.get({type:"unmortgage",count:l},r);n(!1)})(e,r,...a);break;case"payDebt":(async(e,r,a)=>{e.monopoly=await square.get({type:"classic",monopoly:e.monopoly});for(let r=39;r>=0;r--){let a=e.monopoly.square[r];a.owner!==e.monopoly.player.index||a.mortgage||0!==a.house||(gamePlay.get({type:"mortgage",value:r},e),console.log(a.name)),e.monopoly.player.money>=0&&n(e)}n(e)})(e,r,...a);break;case"bid":(async(e,r,a)=>{try{let a;a=e.currentBid+Math.round(20*Math.random()+10),p.money<a+50||r.square[e.property].price}catch(e){}})(e,r,...a);break;case"postBail":(async(e,r,a)=>{try{!p.communityChestJailCard&&!p.chanceJailCard||p.jailroll}catch(e){}})(e,r,...a);break;case"onLand":(async(e,r,a)=>{try{var t;console.log("onLand");for(var o,n,c,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=[5,15,25,35],y=0;y<4;y++)if(0!==(c=square[s[y]]).owner&&c.owner!==p.index){o=c.index;break}square[12].owner===p.index&&square[28].owner!==p.index?n=12:square[28].owner===p.index&&square[12].owner!==p.index&&(n=28),!!(utilityForRailroadFlag&&game.getDie(1)!==game.getDie(2)&&o&&n)&&(utilityForRailroadFlag=!1,i[o]=-1,i[n]=1,t=new Trade(p,player[square[o].owner],0,i,0,0),game.trade(t))}catch(e){}})(e,r,...a)}})};