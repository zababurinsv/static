import mInterface from"./interface.mjs";import monopoly from"./monopoly.mjs";import gameplay from"./gameplay.mjs";export default{get:(e,t,...i)=>new Promise((i,n)=>{function a(e){i(e)}switch(e.type){case"chanceAction":(async(e,t,i)=>{var n=t.player[t.turn];t.chanceCards[e.chanceIndex].action(n,t),await monopoly.get({type:"updateMoney"},t),15===e.chanceIndex||n.human||(n.AI.alertList="",await mInterface.get({type:"next",player:n},e)),a(t)})(e,t);break;case"communityChestAction":(async(e,t,i)=>{var n=t.player[t.turn];t.communityChestCards[e.communityChestIndex].action({player:n},t),await monopoly.get({type:"updateMoney"},t),15===e.communityChestIndex||n.human||(n.AI.alertList="",game.next())})(e,t);break;case"finalizeAuction":(async(e,t,i)=>{let n=t.player[t.highestbidder],r=t.square[t.auctionproperty];t.highestbid>0&&(n.pay(t.highestbid,0,t),r.owner=t.highestbidder,await mInterface.get({type:"addAlert",value:`${n.name} bought ${r.name} for $ ${t.highestbid}.`},t));for(let e=1;e<=t.pcount;e++)t.player[e].bidding=!0;t.this.querySelector("#popupbackground").style.display="none",t.this.querySelector("#popupwrap").style.display="none",await monopoly.auction({type:"auction"},t)||await gameplay.get({type:"play",player:n},t),a(t)})(0,t);break;case"auctionExit":(async(e,t,i)=>{t.player[t.currentbidder].bidding=!1,await mInterface.get({type:"auctionPass"},t)})(0,t);break;case"auctionBid":(async(e,t,i)=>{t.bid=e.bid||parseInt(t.this.getElementById("bid").value,10);let n=e.bid||parseInt(t.this.getElementById("bid").value,10);""===n||null===n?(t.this.getElementById("bid").value="Please enter a bid.",t.this.getElementById("bid").style.color="red"):isNaN(n)?(t.this.getElementById("bid").value="Your bid must be a number.",t.this.getElementById("bid").style.color="red"):n>t.player[t.currentbidder].money?(t.this.getElementById("bid").value="You don't have enough money to bid $"+n+".",t.this.getElementById("bid").style.color="red"):n>t.highestbid?(t.highestbid=n,t.this.getElementById("highestbid").innerHTML=parseInt(n,10),t.highestbidder=t.currentbidder,t.this.getElementById("highestbidder").innerHTML=t.player[t.highestbidder].name,t.this.getElementById("bid").focus(),t.player[t.currentbidder].human&&mInterface.get({type:"auctionPass"},t)):(t.this.getElementById("bid").value="Your bid must be greater than highest bid. ($"+highestbid+")",t.this.getElementById("bid").style.color="red")})(e,t);break;case"auctionPass":(async(e,t,i)=>{for(0===t.highestbidder&&(t.highestbidder=t.currentbidder);;)if(t.currentbidder++,t.currentbidder>t.pcount&&(t.currentbidder-=t.pcount),t.currentbidder==t.highestbidder)await mInterface.get({type:"finalizeAuction"},t),a(t);else if(t.player[t.currentbidder].bidding){let e=t.player[t.currentbidder];if(e.human)break;{let i=e.AI.bid(t.auctionproperty,t.highestbid);if(-1===i||t.highestbid>=e.money){e.bidding=!1,window.alert(e.name+" exited the auction.");continue}if(0===i){window.alert(e.name+" passed.");continue}if(i>0){t.bid=i,await mInterface.get({type:"auctionBid",bid:i},t),window.alert(e.name+" bid $"+i+".");continue}a(t)}}t.this.getElementById("currentbidder").innerHTML=t.player[t.currentbidder].name,t.this.getElementById("bid").value="",t.this.getElementById("bid").style.color="black"})(0,t)}})};