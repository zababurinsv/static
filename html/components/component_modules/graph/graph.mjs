class AudioPlayer{constructor(t){return this.ctx=t.ctx,this.gainNode1=this.ctx.createGain(),this.f1Analyzer=this.ctx.createAnalyser({fftSize:256}),this.mF1=t.f1||130.81,this.mF2=t.f2||164.81,this.mF3=t.f3||196,this.mPlaying=!1,this.mVolume=t.volume||.5,this.mVolume=.33*this.mVolume,this.gainNode1.gain.value=this.mVolume,this.gainNode1.connect(this.ctx.destination),this}_startOscillators(){console.log("starting oscillators"),this.oscNode1=this.ctx.createOscillator(),this.oscNode1.type="sine",this.oscNode1.frequency.value=this.mF1,this.oscNode1.connect(this.gainNode1),this.oscNode1.connect(this.f1Analyzer),this.oscNode1.start(),this.mPlaying=!0}_stopOscillators(){console.log("stopping oscillators"),this.oscNode1.stop(),this.mPlaying=!1}changeGain(t){this.mVolume=.33*t,this.gainNode1.gain.value=this.mVolume}changeFrequency(t,e){switch(t){case 1:this.oscNode1.frequency.value=this.mF1+e}}getAnalyzerBinCount(t){switch(t){case 1:return this.f1Analyzer.frequencyBinCount;default:return 0}}getAnalyzerFFTSize(t){switch(t){case 1:return this.f1Analyzer.fftSize;default:return 0}}getAnalyzerTimeBytes(t,e){switch(t){case 1:this.f1Analyzer.getByteTimeDomainData(e)}}togglePlay(){this.mPlaying?this._stopOscillators():this._startOscillators()}}class ToggleButton{constructor(t={}){this.on=t.on||"⏸",this.off=t.off||"▶️",t.startOn?this.current="on":this.current="off"}toggle(){return"on"===this.current?this.current="off":this.current="on",this[this.current]}}let object={dom:async t=>(t.dom={},t.dom.visualizer={},t.dom.control={},t.dom.playBtnEl=t.this.shadowRoot.getElementById("playButton"),t.dom.playEl=t.this.shadowRoot.querySelector(".svg-audio-btn__play"),t.dom.pauseEl=t.this.shadowRoot.querySelector(".svg-audio-btn__pauseGrp"),t.dom.visualizer.this=t.this.shadowRoot.getElementById("visualizer"),t.dom.visualizer.vCtx=t.dom.visualizer.this.getContext("2d"),t.dom.control.waveCtrl1El=t.this.shadowRoot.getElementById("wave1Control"),t.dom.control.waveCtrl2El=t.this.shadowRoot.getElementById("wave2Control"),t.dom.control.waveCtrl3El=t.this.shadowRoot.getElementById("wave3Control"),t.dom.volumeControl=t.this.shadowRoot.getElementById("volumeControl"),t)};export default async t=>{const e=new(window.AudioContext||window.webkitAudioContext),o=new AudioPlayer({ctx:e,volume:.5}),i=new Uint8Array(o.getAnalyzerFFTSize(1)),s=(new Uint8Array(o.getAnalyzerFFTSize(2)),new Uint8Array(o.getAnalyzerFFTSize(3)),new ToggleButton({on:"pause",off:"play"}));if((t=await object.dom(t)).dom.control.waveCtrl1El.value=0,t.dom.volumeControl.value=.5,"suspended"===e.state&&"ontouchstart"in window){const t=t=>{e.resume()};document.body.addEventListener("touchstart",t,!1),document.body.addEventListener("touchend",t,!1)}t.dom.playBtnEl.addEventListener("click",function(){"pause"===s.toggle()?(t.dom.control.waveCtrl1El.value=0,t.dom.volumeControl.value=.5,t.dom.playEl.classList.add("hidden"),t.dom.pauseEl.classList.remove("hidden")):(t.dom.control.waveCtrl1El.value=0,t.dom.volumeControl.value=.5,t.dom.playEl.classList.remove("hidden"),t.dom.pauseEl.classList.add("hidden")),o.togglePlay()}),[t.dom.control.waveCtrl1El,t.dom.control.waveCtrl2El,t.dom.control.waveCtrl3El].forEach(t=>{t.addEventListener("input",function(t){"on"===s.current&&o.changeFrequency(Number(this.dataset.f),Number(this.value))})}),t.dom.volumeControl.addEventListener("input",function(t){"on"===s.current&&o.changeGain(Number(this.value))}),function e(){let s=t.dom.visualizer.this.width,l=t.dom.visualizer.this.height;window.requestAnimationFrame(e),o.getAnalyzerTimeBytes(1,i),t.dom.visualizer.vCtx.fillStyle="#EEE",t.dom.visualizer.vCtx.fillRect(0,0,s,l),t.dom.visualizer.vCtx.lineWidth=2,function(e,o,i){t.dom.visualizer.vCtx.beginPath(),t.dom.visualizer.vCtx.strokeStyle=o;let n=.75*s/e,a=0;i.forEach(e=>{let o=i[e]/256*l;0===e?t.dom.visualizer.vCtx.moveTo(a,o):t.dom.visualizer.vCtx.lineTo(a,o),a+=n}),t.dom.visualizer.vCtx.lineTo(s,l/2),t.dom.visualizer.vCtx.stroke()}(o.getAnalyzerFFTSize(1),"#26a69a",i)}()};