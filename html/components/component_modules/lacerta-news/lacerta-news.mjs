import action from"/static/html/components/component_modules/action/action.mjs";import staticProperty from"/static/html/components/component_modules/staticProperty/staticProperty.mjs";(async()=>{bundle.default({input:"object"},null,async function(e,t){for(let e=0;e<t.store["lacerta-news"].length;e++)switch(t.store["lacerta-news"][e].slot){case"news-admin":t.store["lacerta-news"][e].img=t.store["lacerta-news"][e].this.shadowRoot.querySelector(".gallery")}await staticProperty({input:"lacerta-news",type:"store",store:t.store["lacerta-news"]},"set","type");for(let e=0;e<t.store["lacerta-news"].length;e++)switch(t.store["lacerta-news"][e].slot){case"news-admin":t.store["lacerta-news"][e].this.shadowRoot.querySelector("#image").onchange=function(a){let r=new CustomEvent("sideBarCrop",{detail:{id:"lacerta-news",slot:t.store["lacerta-news"][e].slot,file:a.target.files[0]}});document.dispatchEvent(r),a.target.value=""};break;case"lacerta-news":let a=await action({input:"lacerta-news",type:"template"},"get","type");if(a.items)if(0===a.items.length);else{t.store["lacerta-news"][e].this.shadowRoot.querySelector("#news").innerHTML="";for(let r=0;r<a.items.length;r++){t.store["lacerta-news"][e].this.shadowRoot.querySelector("#news").insertAdjacentHTML("beforeend",a.items[r]);let o=t.store["lacerta-news"][e].this.shadowRoot.querySelector(`.item_${r}`),n=o.querySelector(".date").parentNode,s=o.querySelector(".timestamp").innerText;s=+s;let l=new Date(s);l=l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear(),n.querySelector(".date").style.display="none",n.querySelector(".title").insertAdjacentHTML("afterend",`<h3>${l}</h3>`),o.addEventListener("click",e=>{"/admin"===window.location.pathname||"/admin/"===window.location.pathname?e.target.open=!0:"SUMMARY"===e.target.parentNode.parentNode.tagName&&"SECTION"===e.target.parentNode.tagName?"DIV"===e.target.tagName&&"SECTION"===e.target.parentNode.tagName&&(e.preventDefault(),e.target.open=!1):"SUMMARY"===e.target.parentNode.tagName&&"P"===e.target.tagName||"SPAN"===e.target.tagName&&"P"===e.target.parentNode.tagName&&"SUMMARY"===e.target.parentNode.parentNode.tagName||"EM"===e.target.tagName&&"P"===e.target.parentNode.tagName||("A"===e.target.tagName&&"P"===e.target.parentNode.tagName?console.log("dddddddddddd4444ddddd"):(e.preventDefault(),e.target.open=!1))}),o.querySelector(".delete").addEventListener("click",e=>{let t=e.target,a=!1;for(;!a;)"DETAILS"===t.tagName&&t.className.indexOf("item")>-1?a=!0:t=t.parentNode;let r={};r.timestamp=t.querySelector(".timestamp").innerText,r.timestamp=+r.timestamp,r.iso=t.querySelector(".date").innerText,r.utc=new Date(r.timestamp).toUTCString(),confirm("Вы точно хотите удалить новость ?")&&(t.querySelector(".change").remove(),t.querySelector(".delete").innerText="Идёт процесс удаления",t.querySelector(".delete").style.backgroundColor="red",t.querySelector(".delete").disabled=!0,staticProperty({type:"task",task:{type:"delete",date:r,remove:t}},"task","type"))}),o.querySelector(".change").addEventListener("click",async e=>{let t=e.target,a=!1;for(;!a;)"DETAILS"===t.tagName&&t.className.indexOf("item")>-1?a=!0:t=t.parentNode;e.target.innerText="данные добавляются в редактор",e.target.disabled=!0;let r={};r.timestamp=t.querySelector(".timestamp").innerText,r.timestamp=+r.timestamp,r.iso=t.querySelector(".date").innerText,r.utc=new Date(r.timestamp).toUTCString(),staticProperty({type:"task",task:{button:e.target,type:"update",date:r,this:t}},"task","type")})}}else;}})})();