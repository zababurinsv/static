import action from"/static/html/components/component_modules/action/action.mjs";customElements.define("lacerta-feed",class extends HTMLElement{constructor(){super();let t=[],e=[],s=[],l=[];function n(t){return new Promise(function(e,s){let l=document.createElement("style"),n=document.createElement("style");for(let e=0;e<t.type.length;e++)"swap"===t.type[e]?"scoped"===t.type[e]&&l.setAttribute("scoped",""):"scoped"===t.type[e]&&n.setAttribute("scoped","");for(let s=0;s<t.state.length;s++){switch(t[`path-style-${t.state[s]}`]=`@import '/static/html/components/${t.component}/${t.state[s]}/${t.component}.css'; @import '/static/html/components/${t.component}/${t.state[s]}/${t.component}-custom.css';`,t.state[s]){case"shadow":!0===t.verify.preset&&(t[`path-style-${t.state[s]}-preset`]=`@import '/static/html/components/${t.component}/template/${t.preset}/${t.component}-${t.preset}.css';`),l.innerText=t[`path-style-${t.state[s]}`]+t[`path-style-${t.state[s]}-preset`];break;case"light":!0===t.verify.preset&&(t[`path-style-${t.state[s]}-preset`]=`@import '/static/html/components/${t.component}/template/${t.preset}/${t.component}-${t.preset}.css';`),n.innerText=t[`path-style-${t.state[s]}`]+t[`path-style-${t.state[s]}-preset`]}"swap"===t.state[s]?!0===t.shadowRoot?(t.this.shadowRoot.appendChild(n),t.this.appendChild(l),e(t)):t.this.appendChild(l):!0===t.shadowRoot?(t.this.shadowRoot.appendChild(l),t.this.appendChild(n),e(t)):t.this.appendChild(n)}e(t)})}function r(e,s){return new Promise(function(s,l){e.verify=[],e.this.hasAttribute("preset")?(e["path-template"]=`/static/html/components/${e.component}/template/${e.this.getAttribute("preset")}.html`,e.preset=`${e.this.getAttribute("preset")}`,e.verify.preset=!0):(e["path-template"]=`/static/html/components/${e.component}/${e.component}.html`,e.verify.preset=!1),fetch(e["path-template"]).then(function(t){if(t.ok)return t.text()}).then(function(l){let n=(new DOMParser).parseFromString(l,"text/html");e.template=n.getElementsByTagName("template")[0].content.cloneNode(!0),function(e){return new Promise(function(s,l){e["path-external"]=`/static/html/components/${e.component}/external/${e.component}-external.html`,fetch(e["path-external"]).then(function(t){return!1===t.ok?t.ok:t.text()}).then(function(l){if(!1===l);else{let n=(new DOMParser).parseFromString(l,"text/html");e.external=n.querySelectorAll("section"),function(e){return new Promise(function(s,l){e["external-property"]=t["external-property"];let n=[],r=[],i=[];for(let t=0;t<e.external.length;t++){for(let s=0;s<e.external[t].children.length;s++)switch(e.external[t].children[s].tagName){case"SCRIPT":e.external[t].getAttribute("id")&&(r.script=e.external[t].children[s]);break;case"COMPONENT-ID":r.id=e.external[t].children[s].innerText;break;case"COMPONENT-ACTION":for(let l=0;l<e.external[t].children[s].children.length;l++)i.push(e.external[t].children[s].children[l].innerText);r.actions=i}n.push(r),r=[]}e["external-property"]=n,s(e)}).catch(t=>{})}(e).then(t=>{0===t["external-property"].length?s(t):function(t){return new Promise(function(e,s){t["words-action"]=[];let l=[];for(let s=0;s<t["external-property"].length;s++){for(let e=0;e<t["external-property"][s].actions.length;e++)for(let n=0;n<t.words.length;n++)-1!==t["external-property"][s].actions[e].indexOf(t.words[n])&&("shadowRoot"!==t.words[n]&&"shadow"!==t.words[e]||(l.shadow=!0),"light"!==t.words[n]&&"лайт"!==t.words[e]||(l.light=!0),"editor"===t.words[n]&&(l.editor=!0),"слайдер"===t.words[n]&&(l["editor-slider"]=!0),"swap"===t.words[n]&&(l.swap=!0));t["words-action"]=l;for(let e in t["external-property"])for(let s in t["external-property"][e])switch(s){case"id":let l=document.createElement(t["external-property"][e][s]);l.setAttribute("type","external"),t.this.appendChild(l)}e(t)}})}(t).then(t=>{s(t)})})}}).catch(t=>{throw t})})}(e).then(t=>{(function(t,e,s){return new Promise(function(e,s){t["template-shadow"]=[],t["template-light"]=[];let l=[];l.swap=!1,l.external=!1,l.light=!1,l.slider=!1,l.one=!1,l.sliderText=!1,l.text=!1;for(let e=0;e<t.type.length;e++){if(-1!==t.type[e].indexOf("slider")&&t.type[e].split("-").length>1){l.slider=!0;for(let s in t.type[e].split("-"))switch(t.type[e].split("-")[s]){case"one":l.one=!0}}if(t.type[e].length)switch(t.type[e]){case"swap":l.swap=!0;break;case"external":l.external=!0;break;case"light":l.light=!0;break;case"slider":l.slider=!0;break;case"sliderText":l.sliderText=!0;break;case"text":l.text=!0}}if(!0===l.swap){for(let e=0;e<t.this.children.length;e++)1===t.this.children[e].tagName.split("-").length?("view"===t.this.children[e].slot&&(t.this.children[e].className="wall"),t["template-light"].push(t.this.children[e])):!0===t.getAttribute(t.this.children[e],"light","template")?(t.this.children[e].setAttribute("type",`${t.this.children[e].getAttribute("type")}-external`),console.log("ssssssssssssss11111111"),i(t.this.children[e]),t["template-light"].push(t.this.children[e])):(t.this.children[e].setAttribute("type",`${t.this.children[e].getAttribute("type")}-external`),console.log("ssssssssssssss222222222"),i(t.this.children[e]),console.log("3333333333",t.this.children[e]),t["template-shadow"].push(t.this.children[e]));for(let e=0;e<t.template.children.length;e++)1===t.template.children[e].tagName.split("-").length?("view"===t.template.children[e].slot&&(t.template.children[e].className="wall"),t["template-light"].push(t.template.children[e])):!0===t.getAttribute(t.template.children[e],"light","template")?(t.template.children[e].setAttribute("type",`${t.template.children[e].getAttribute("type")}-external`),console.log("ssssssssssssss333333333"),i(t.template.children[e]),t["template-light"].push(t.template.children[e])):(t.template.children[e].setAttribute("type",`${t.template.children[e].getAttribute("type")}-external`),console.log("ssssssssssssss4444444444"),i(t.template.children[e]),console.log("333333444443333",t.this.children[e]),t["template-shadow"].push(t.template.children[e]))}else{for(let e=0;e<t.this.children.length;e++)1===t.this.children[e].tagName.split("-").length?("view"===t.this.children[e].slot&&(t.this.children[e].className="wall"),t["template-shadow"].push(t.this.children[e])):!0===t.getAttribute(t.this.children[e],"light","template")?(console.log("ssssssssssssss555555555"),i(t.this.children[e]),t["template-shadow"].push(t.this.children[e]),console.log("33333344555554443333",t.this.children[e])):(console.log("ssssssssssssss666666666666"),i(t.this.children[e]),t["template-light"].push(t.this.children[e]));for(let e=0;e<t.template.children.length;e++)1===t.template.children[e].tagName.split("-").length?("view"===t.template.children[e].slot&&(t.template.children[e].className="wall"),"SCRIPT"===t.template.children[e].tagName?(t["template-head"]=[],t["template-head"].push(t.template.children[e]),colorLog("<varan-rss>obj['template-head']</varan-rss>",t.template.children[e])):t["template-shadow"].push(t.template.children[e])):!0===t.getAttribute(t.template.children[e],"light","template")?(console.log("ssssssssssssss7777777777777"),i(t.template.children[e]),console.log("333333445777777888887755554443333",t.this.children[e]),t["template-shadow"].push(t.template.children[e])):(console.log("ssssssssssssss888888888888888"),i(t.template.children[e]),t["template-light"].push(t.template.children[e]))}for(let e in l)t.verify[e]=l[e];!0===t.verify.slider?function(t){return new Promise(function(e,s){fetch(`/static/html/components/varan-slider/template/${t.slot}.html`).then(function(t){if(t.ok)return t.text()}).then(function(e){let s=(new DOMParser).parseFromString(e,"text/html");t.slider=s.getElementsByTagName("template")[0].content.cloneNode(!0);let l=document.createElement("section");l.className="slider",l.slot="view",l.appendChild(t.slider),t.slider=l,t["slider-template"]=l,t.verify.sliderText=!1;for(let e=0;e<t.type.length;e++)"slider-one-text"===t.type[e]&&(t.verify.sliderText=!0)}).catch(t=>t)})}(t).then(t=>{t["template-light"].push(t.slider),t.this.appendChild(t.slider),function(t,e){return new Promise(function(e,s){(function(t,e){return new Promise(function(s,l){for(let l=0;l<t.state.length;l++)for(let n=0;n<t[`template-${t.state[l]}`].length;n++)0===t[`template-${t.state[l]}`][n].getElementsByClassName(e).length||(t.slider=t[`template-${t.state[l]}`][n].getElementsByClassName(e)[0],s(t[`template-${t.state[l]}`][n].getElementsByClassName(e)[0]))})})(t,"peppermint").then(s=>{(function(t){return new Promise(function(e,s){e(Peppermint(t,{dots:!1,slideshow:!1,speed:500,slideshowInterval:5e3,stopSlideshowAfterInteraction:!0,onSetup:function(t){}}))})})(s).then(s=>{t.slider=s,e(t)})}),e(t)})}(t).then(t=>{if(!0===t.verify.one)for(let s=0;s<t.state.length;s++)for(let l=0;l<t[`template-${t.state[s]}`].length;l++)"wall"===t[`template-${t.state[s]}`][l].className&&(t[`template-${t.state[s]}`].splice(l,1),e(t));else e(t)})}):e(t)})})(t,t["type-swap"],t["type-external"]).then(t=>{let e={};for(let s=0;s<t["template-light"].length;s++)"VARAN-MENU"===t["template-light"][s].tagName&&(e=t["template-light"].splice(s,1),t["template-light"].push(e[0]));if(!0===t.verify.swap){if(0!==t["template-shadow"].length){t.this.attachShadow({mode:"open"}),t.shadowRoot=!0;for(let e=0;e<t["template-shadow"].length;e++)t.this.shadowRoot.appendChild(t["template-shadow"][e])}if(0!==t["template-light"].length)for(let e=0;e<t["template-light"].length;e++)t.this.appendChild(t["template-light"][e]);console.assert(!0,t["template-head"])}else{if(0!==t["template-shadow"].length){t.this.attachShadow({mode:"open"}),t.shadowRoot=!0;for(let e in t["template-shadow"])t.this.shadowRoot.appendChild(t["template-shadow"][e])}if(0!==t["template-light"].length)for(let e in t["template-light"])t.this.appendChild(t["template-light"][e])}s(t)})})}).catch(t=>t)})}function i(t){return new Promise(function(e,s){const l=document.createElement("script");let n=!1;for(let e in document.head.getElementsByTagName("script"))"object"==typeof document.head.getElementsByTagName("script")[e]&&-1!==document.head.getElementsByTagName("script")[e].outerHTML.indexOf(t.tagName.toLowerCase())&&(n=!0);!0===n?colorLog("<varan-rss>script уже загружен</varan-rss>","yellow"):(l.src=`/static/html/components/${t.tagName.toLowerCase()}/${t.tagName.toLowerCase()}.mjs`,l.type="module",l.setAttribute("async",""),l.onload=e,l.onerror=s,document.head.appendChild(l))})}var a;e.push("component-id"),e.push("script"),e.push("component-action"),s.push("h1"),s.push("innerText"),l.push("shadowRoot"),l.push("head"),l.push("shadow"),l.push("light"),l.push("lightDom"),l.push("editor"),l.push("слайдер"),l.push("swap"),t.this=this,t["type-supported"]=s,(a=this,new Promise(function(t,e){let s=[];s.staticProperty=[],s.staticProperty.c=0,s.state=[],s.state.push("shadow"),s.state.push("light"),s.words=l,s["type-swap"]=!1,s["type-external"]=!1,s["document-offsetWidth"]=document.body.offsetWidth;let n=!1;if(s.getAttribute=((t,e,s)=>{if("template"===s){if(!t.getAttribute("type"))return t.setAttribute("type","default"),!1;for(let s=0;s<t.getAttribute("type").split("-").length;s++)t.getAttribute("type").split("-")[s]===e&&(n=!0);return n}if(t[`verify-${e}`]=!1,0===t.this.getAttribute("type").split("-").length)return!1;for(let s=0;s<t.this.getAttribute("type").split("-").length;s++)t.this.getAttribute("type").split("-")[s]===e?t[`verify-${e}`]=!0:t[`verify-${e}`]=!1;return t[`verify-${e}`]}),a.tagName.toLowerCase()&&(s.component=a.tagName.toLowerCase()),"object"!=typeof a);else{if(a.getAttribute("type")){s.type=a.getAttribute("type").split("-");for(let t=0;t<s.type.length;t++)s.type[t]=s.type[t].replace(/:/g,"-");for(let t in s.type)switch(s.type[t]){case"swap":s["type-swap"]=!0;break;case"external":s["type-external"]=!0}}else s.type=["default"],a.setAttribute("type","default");if(a.slot?s.slot=a.slot:(a.slot=a.tagName.toLowerCase(),s.slot=a.slot),a.getAttribute("type")){let t=!1;for(let e in a.getAttribute("type").split("-"))-1!==a.getAttribute("type").split("-")[e].indexOf("style:")&&(t=!0);s["style-custom"]=!0===t?"not-default":"default"}}a.hasAttribute("parent")?s.parent=a.getAttribute("parent"):console.warn("нет родительского элемента parent"),s.shadowRoot=!1,s.this=a,t(s)})).then(t=>{r(t).then(t=>{n(t).then(t=>{!async function(t){await action({input:"lacerta-feed",this:t.this,type:"store"},"set","type");let e=await action({input:"lacerta-feed",type:"feeds"},"get","type"),s=document.createElement("pre");0===e.mongo.length?(s.innerText="нет каналов",t.this.shadowRoot.appendChild(s)):(n="word-wrap: break-word; white-space: pre-wrap;",s.style.wordWrap,s.innerText=e.mongo[0].feed.rss,s.innerText=s.innerText.replace(/<!\[CDATA\[(.*)\]\]>/g,"$1"),t.this.shadowRoot.appendChild(s))}(t)})})})}});