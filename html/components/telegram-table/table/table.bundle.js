!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var a=e=>new Promise(async(t,n)=>{let a=await function(e){return new Promise(async(t,n)=>{let a="";if("null"===e)a+='<option value="0">0</option>';else{e=e.split(",");let t=[];for(let n=0;n<e.length;n++){let a=e[n].replace(/[^-0-9]/gim,"");0!==a.length&&(a.length>1?console.warn("слишком большое колличество символов"):t.push(a))}for(let e=0;e<t.length;e++)a+=`<option value="${t[e]}">${t[e]}</option> \n`}t(a)})}(e.plans),r=await function(e){return new Promise(async(t,n)=>{let a="";if("null"===e)a+='<option value="0">0</option>';else{e=e.split(",");for(let t=0;t<e.length;t++)e[t]=e[t].replace(/^\s*(.*)\s*$/,"$1"),a+=`<option value="${e[t]}">${e[t]}</option> \n`}t(a)})}(e.price);switch(parseInt(e.city,10)){case 0:e.city="неизвестный";break;case 1:e.city="Москва";break;case 2:e.city="Санкт-Петербург";break;default:e.city="неизвестный"}(e=>{t(e)})(`\n<tr>\n<td class="id">${e.id}</td>\n<td class="city">${e.city}</td>\n<td class="name">${e.name}</td>\n<td class="object">${e.object}</td>\n<td class="dateExperiences">${e.dateExperiences}</td>\n<td class="class">${e.class}</td>\n<td class="type">${e.type}</td>\n<td class="metro">${e.metro}</td>\n<td class="geo">${e.geo}</td>\n<td class="plan"><select class  ="form-control search_input_plan" name="plan">${a}</select></td>\n<td class="price"><select class  ="form-control search_input_plan" name="price">${r}</select></td>\n<td class="finish">${e.finish}</td>\n<td class="addition">${e.description}</td>\n<td>\n<a class="button button-lg btn-lg edit" title="Edit">\n<i class="fa fa-save" title="Save"></i></a> \n<a class="button btn-lg button-lg delete" title="Delete">\n<i class="fa fa-trash"></i>\n</a>\n</td>\n</tr>`)}),r=e=>new Promise(async(t,n)=>{let a=e=>{t(e)};a(void 0===e?'\n<form action="" id="object-form">\n   <div class="form-group">\n    <select class  ="form-control search_input_city" id="city" name="plan">\n            <option value="0">Неизвестный</option>\n            <option value="1">Москва</option>\n            <option value="2">Санкт-Петербург</option>\n    </select>\n    </div>\n    <div class="form-group">\n    <label for="name" class="control-label">Застройщик<span class="text-danger">*</span></label>\n    <input type="text" name="name" class="form-control" id="name" value="">\n    </div>\n    <div class="form-group">\n    <label for="object" class="control-label">Объект<span class="text-danger">*</span></label>\n    <input type="text" name="object" class="form-control" id="object" value="">\n    </div>\n    <div class="form-group">\n    <label for="dateExperiences" class="control-label">Срок Сдачи <span class="text-danger">*</span></label>\n<input type="text" name="dateExperiences" id="dateExperiences" class="form-control js-transition" value=""/>\n    </div>\n    <div class="form-group">\n    <label for="anons" class="control-label">Класс жилья</label>\n<textarea style="resize: vertical;" class="form-control" name="class" rows="2" ></textarea>\n    </div>\n    <div class="form-group">\n    <label for="anons" class="control-label">Тип жилья</label>\n<textarea style="resize: vertical;" class="form-control" name="type" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Метро</label>\n    <textarea style="resize: vertical;" class="form-control" name="metro" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">ГЕО</label>\n    <textarea style="resize: vertical;" class="form-control" name="geo" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Планироки</label>\n    <textarea style="resize: vertical;" class="form-control" name="plans" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Цена от</label>\n<textarea style="resize: vertical;" class="form-control" name="price" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Отделка</label>\n    <textarea style="resize: vertical;" class="form-control" name="finish" rows="2"></textarea>\n</div>\n<div class="form-group">\n    <label for="description" class="control-label">Дополнительная информация</label>\n    <textarea class="form-control ckeditor" id="description" name="description" rows="3"></textarea>\n</div>\n<div class="form-group">\n<form id="file-upload-form" class="uploader" >\n  <input id="file-upload" type="file"  name="fileUpload" accept="image/*" style="display: none" />\n  <label for="file-upload" id="file-drag">\n    <div id="start">\n      <span id="file-upload-btn" class="btn btn-primary">Добавить изображение</span>\n    </div>\n    <div id="response" class="hidden">\n      <div id="messages"></div>\n      <progress class="progress" id="file-progress" value="0">\n        <span>0</span>%\n      </progress>\n    </div>\n  </label>\n</form>\n</div>\n</div>\n<button type="button" name="save_page_form"  class="btn btn-success">Сохранить</button>\n    </form>\n':`\n<form action="" id="object-form">\n   <div class="form-group">\n    <select class  ="form-control search_input_city" id="city" name="plan">\n            <option value="0">Неизвестный</option>\n            <option value="1">Москва</option>\n            <option value="2">Санкт-Петербург</option>\n    </select>\n    </div>\n\n    <div class="form-group">\n    <label for="name" class="control-label">Застройщик<span class="text-danger">*</span></label>\n    <input type="text" name="name" class="form-control" id="name" value= "${e.name}" />\n    </div>\n    <div class="form-group">\n    <label for="object" class="control-label">Объект<span class="text-danger">*</span></label>\n    <input type="text" name="object" class="form-control" id="object" value="${e.object}">\n    </div>\n    <div class="form-group">\n    <label for="dateExperiences" class="control-label">Срок Сдачи <span class="text-danger">*</span></label>\n    <textarea style="resize: vertical;" name="dateExperiences" id="dateExperiences" class="form-control js-transition" >${e.dateExperiences}</textarea>\n    </div>\n    <div class="form-group ">\n    <label for="anons" class="control-label">Класс жилья</label>\n<textarea style="resize: vertical;" class="form-control" name="class" rows="2" >${e.class}</textarea>\n    </div>\n    <div class="form-group">\n    <label for="anons" class="control-label">Тип жилья</label>\n<textarea style="resize: vertical;" class="form-control" name="type" rows="2">${e.type}</textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Метро</label>\n    <textarea style="resize: vertical;" class="form-control" name="metro" rows="2">${e.metro}</textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">ГЕО</label>\n    <textarea style="resize: vertical;" class="form-control" name="geo" rows="2">${e.geo}</textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Планироки</label>\n    <textarea style="resize: vertical;" class="form-control" name="plans" rows="2">${e.plans}</textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Цена от</label>\n<textarea style="resize: vertical;" class="form-control" name="price" rows="2">${e.price}</textarea>\n</div>\n<div class="form-group">\n    <label for="anons" class="control-label">Отделка</label>\n    <textarea style="resize: vertical;" class="form-control" name="finish" rows="2">${e.finish}</textarea>\n</div>\n<div class="form-group">\n    <label for="description" class="control-label">Дополнительная информация</label>\n    <textarea class="form-control ckeditor" id="description" name="description" rows="3">${e.description}</textarea>\n</div>\n</div>\n<div class="form-group">\n<form id="file-upload-form" class="uploader" >\n  <input id="file-upload" type="file"  name="fileUpload" accept="image/*" style="display: none" />\n  <label for="file-upload" id="file-drag">\n    <div id="start">\n      <span id="file-upload-btn" class="btn btn-primary">Добавить изображение</span>\n    </div>\n    <div id="response" class="hidden">\n      <div id="messages"></div>\n      <progress class="progress" id="file-progress" value="0">\n        <span>0</span>%\n      </progress>\n    </div>\n  </label>\n</form>\n</div>\n<button type="button" name="save_page_form"  class="btn btn-success">Сохранить</button>\n    </form>\n`)});function s(e,t){return new Promise(async(n,a)=>{if(window.indexedDB){let a={};a.name=e.name,a.version=e.version;try{a.request=window.indexedDB.open(`${e.name}`,`${e.version}`)}catch(e){console.assert(!1)}a.request.onsuccess=function(e){t(a.request.result)},a.request.onerror=function(e){},a.request.onupgradeneeded=function(t){switch(e.name){case"flatory":if(a.db=t.target.result,a.objectStore=a.db.createObjectStore("cat_object",{keyPath:"id"}),a.objectStore.createIndex("city","city",{unique:!1}),a.objectStore.createIndex("class","class",{unique:!1}),a.objectStore.createIndex("dateExperiences","dateExperiences",{unique:!1}),a.objectStore.createIndex("description","description",{unique:!1}),a.objectStore.createIndex("finish","finish",{unique:!1}),a.objectStore.createIndex("geo","geo",{unique:!1}),a.objectStore.createIndex("metro","metro",{unique:!1}),a.objectStore.createIndex("name","name",{unique:!1}),a.objectStore.createIndex("object","object",{unique:!1}),a.objectStore.createIndex("plans","plans",{unique:!1}),a.objectStore.createIndex("price","price",{unique:!1}),a.objectStore.createIndex("tags","tags",{unique:!1}),a.objectStore.createIndex("timestamp","timestamp",{unique:!1}),a.objectStore.createIndex("timestampUpdate","timestampUpdate",{unique:!1}),a.objectStore.createIndex("type","type",{unique:!1}),e.data)for(let t in e.data)a.objectStore.add(e.data[t]);break;case"dictionary":if(a.db=t.target.result,a.objectStore=a.db.createObjectStore("dictionary",{autoIncrement:!0}),e.data)for(let t in e.data)a.objectStore.add(e.data[t])}n(a)}}else window.alert("Ваш браузер не поддерживат стабильную версию IndexedDB. Такие-то функции будут недоступны")})}var o={get:async(e,t,...n)=>new Promise(async(t,n)=>{let a=e=>{t(e)};switch(e.type){case"dictionary":(async(e,t,n)=>{await s({name:"dictionary",version:1,data:e.data},async e=>{let t=[];e.transaction(["dictionary"],"readwrite").objectStore("dictionary").openCursor().onsuccess=e=>{let n=e.target.result;n?(t.push(n.value),n.continue()):a(t)}})})(e);break;case"id":(async(e,t,n)=>{await s({name:"flatory",version:1},async t=>{let n=[];0===e.id.length?t.transaction(["cat_object"],"readwrite").objectStore("cat_object").openCursor().onsuccess=e=>{let t=e.target.result;t?(n.push(t.value),t.continue()):a(n)}:t.transaction(["cat_object"],"readwrite").objectStore("cat_object").get(e.id).onsuccess=e=>{a(e.target.result)}})})(e);break;case"getAll":(async(e,t,n)=>{await s({name:"flatory",version:1},async e=>{let t=[];e.transaction(["cat_object"],"readwrite").objectStore("cat_object").openCursor().onsuccess=e=>{let n=e.target.result;n?(t.push(n.value),n.continue()):a(t)}})})();break;case"index":(async(e,t,n)=>{await s({name:"flatory",version:1},async t=>{let n=t.transaction(["cat_object"],"readwrite").objectStore("cat_object").index(`${e.index}`),r=[];if("price"===e.index)n.openCursor().onsuccess=function(t){let n=t.target.result;if(n){let t=n.key.split(","),a=!1;const s=/[^\d\.\' ']/g;for(let n=0;n<t.length;n++){let r=t[n].replace(s,"");r=(r=(r=r.replace(/^\s+/g,"")).split(" "))[0],r=parseFloat(r);let o=parseFloat(e.filter);isNaN(r)?a=!0:isNaN(o)?a=!0:o>=r&&(a=!0)}a&&r.push(n.value),n.continue()}else a(r)};else if("city"===e.index){let n=t.transaction(["cat_object"],"readwrite").objectStore("cat_object").index(`${e.index}`),r=[];n.openCursor().onsuccess=function(t){let n=t.target.result;n?(0===parseInt(e.filter,10)?r.push(n.value):parseInt(n.key,10)===parseInt(e.filter,10)&&r.push(n.value),n.continue()):a(r)}}else n.openCursor().onsuccess=function(t){let n=t.target.result;n?(n.key.toLowerCase().indexOf(e.filter.toLowerCase())>-1&&r.push(n.value),n.continue()):a(r)}})})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),put:async(e,t,...n)=>new Promise(async(t,n)=>{let a=e=>{t(e)};switch(e.type){case"data":(async(e,t,n)=>{let r=await fetch("http://dev.work/api/item",{method:"GET"}).then(e=>e.json());await s({name:"flatory",version:1},async e=>{for(let t in r)e.transaction(["cat_object"],"readwrite").objectStore("cat_object").put(r[0]).onsuccess=e=>{r.length-1==t&&a(!0)}})})();break;case"item":(async(e,t,n)=>{await s({name:"flatory",version:1},async t=>{t.transaction(["cat_object"],"readwrite").objectStore("cat_object").put(e.value).onsuccess=e=>{a(!0)}})})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),delete:async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"test":(async(e,n,a)=>{await s({name:"flatory",version:1},async e=>{e.transaction(["cat_object"],"readwrite").objectStore("cat_object").delete("144").onsuccess=e=>{console.log(e.target.result),(e=>{t(e)})(!0)}})})();break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),set:async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"dictionary":(async(e,n,a)=>{await s({name:"dictionary",version:1,data:e.data},async e=>{(e=>{t(e)})(!0)})})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}})},i=async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"item":((e,n,a)=>{(e=>{t(e)})(sessionStorage.setItem(e.key,e.value))})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),l=async(e,t,...n)=>new Promise(async(t,n)=>{let a=e=>{t(e)};switch(e.type){case"item":((e,t,n)=>{a(sessionStorage.getItem(e.key))})(e);break;case"all":((e,t,n)=>{let r=Object.keys(sessionStorage),s=[];for(let e=0;e<r.length;e++)r[e].split("_").length>1||s.push(JSON.parse(sessionStorage.getItem(r[e])));a(s)})();break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),c=async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"item":((e,n,a)=>{(e=>{t(e)})(sessionStorage.removeItem(e.key))})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),d=async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"sessionStorage":(async(e,t,n)=>{await i({type:"item",key:`item_${e.key}`,value:e.value})})(e),(e=>{t(e)})(!0);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),p=async(e,t,...n)=>new Promise(async(t,n)=>{let a=e=>{t(e)};switch(e.type){case"sessionStorage":(async(e,t,n)=>{let r=Object.keys(sessionStorage),s=[];if(s.city=!1,s.class=!1,s.dateExperiences=!1,s.description=!1,s.finish=!1,s.geo=!1,s.id=!1,s.metro=!1,s.name=!1,s.object=!1,s.plans=!1,s.price=!1,s.tags=!1,s.type=!1,0===r.length){for(let t in s)t===e.item?i({type:"item",key:`item_${t}`,value:-10}):i({type:"item",key:`item_${t}`,value:-9});a(!1)}else{let t=!1,n=!0,r={};for(let a in s)if(a===e.item)0===e.length?i({type:"item",key:`item_${a}`,value:-9}):i({type:"item",key:`item_${a}`,value:-10});else{let e=await l({type:"item",key:`item_${a}`});if(-10===parseInt(e,10)){if(n)switch(a){case"city":r=await o.get({type:"index",index:"city",filter:document.getElementById("search_input_City").value.toLowerCase()});break;case"class":r=await o.get({type:"index",index:"class",filter:document.getElementById("search_input_houseClass").value.toLowerCase()});break;case"dateExperiences":r=await o.get({type:"index",index:"dateExperiences",filter:document.getElementById("search_input_Deadline").value.toLowerCase()});break;case"description":r=await o.get({type:"index",index:"description",filter:document.getElementById("search_input_AdditionalInfo").value.toLowerCase()});break;case"finish":r=await o.get({type:"index",index:"finish",filter:document.getElementById("search_input_Finish").value.toLowerCase()});break;case"geo":r=await o.get({type:"index",index:"geo",filter:document.getElementById("search_input_geo").value.toLowerCase()});break;case"id":r=await o.get({type:"id",id:document.getElementById("search_input_id").value.toLowerCase()});break;case"metro":r=await o.get({type:"index",index:"metro",filter:document.getElementById("search_input_Metro").value.toLowerCase()});break;case"name":r=await o.get({type:"index",index:"name",filter:document.getElementById("search_input_Developer").value.toLowerCase()});break;case"object":r=await o.get({type:"index",index:"object",filter:document.getElementById("search_input_Object").value.toLowerCase()});break;case"plans":r=await o.get({type:"index",index:"plans",filter:document.getElementById("search_input_plan").value.toLowerCase()});break;case"price":r=await o.get({type:"index",index:"price",filter:document.getElementById("search_input_price").value.toLowerCase()});break;case"tags":break;case"type":r=await o.get({type:"index",index:"type",filter:document.getElementById("search_input_houseType").value.toLowerCase()});break;default:console.assert(!1,`необрабатываемый запрос ${a}`)}else switch(a){case"city":r=await o.get({type:"index",index:"city",filter:document.getElementById("search_input_City").value.toLowerCase()});break;case"class":r=await o.get({type:"index",index:"class",filter:document.getElementById("search_input_houseClass").value.toLowerCase()});break;case"dateExperiences":r=await o.get({type:"index",index:"dateExperiences",filter:document.getElementById("search_input_Deadline").value.toLowerCase()});break;case"description":r=await o.get({type:"index",index:"description",filter:document.getElementById("search_input_AdditionalInfo").value.toLowerCase()});break;case"finish":r=await o.get({type:"index",index:"finish",filter:document.getElementById("search_input_Finish").value.toLowerCase()});break;case"geo":r=await o.get({type:"index",index:"geo",filter:document.getElementById("search_input_geo").value.toLowerCase()});break;case"id":r=await o.get({type:"id",id:document.getElementById("search_input_id").value.toLowerCase()});break;case"metro":r=await o.get({type:"index",index:"metro",filter:document.getElementById("search_input_Metro").value.toLowerCase()});break;case"name":r=await o.get({type:"index",index:"name",filter:document.getElementById("search_input_Developer").value.toLowerCase()});break;case"object":r=await o.get({type:"index",index:"object",filter:document.getElementById("search_input_Object").value.toLowerCase()});break;case"plans":r=await o.get({type:"index",index:"plans",filter:document.getElementById("search_input_plan").value.toLowerCase()});break;case"price":r=await o.get({type:"index",index:"price",filter:document.getElementById("search_input_price").value.toLowerCase()});break;case"tags":break;case"type":r=await o.get({type:"index",index:"type",filter:document.getElementById("search_input_houseType").value.toLowerCase()});break;default:console.assert(!1,`необрабатываемый запрос ${a}`)}if(n)if(void 0===r)n=!1;else{for(let e=0;e<r.length;e++)i({type:"item",key:`${r[e].id}`,value:JSON.stringify(r[e])});n=!1}else if(void 0===r){let e=await l({type:"all"});for(let t=0;t<e.length;t++)c({type:"item",key:e[t].id})}else{let e=await l({type:"all"});for(let t=0;t<e.length;t++){let n=!1;for(let a=0;a<r.length;a++)e[t].id===r[a].id&&(n=!0);n||c({type:"item",key:e[t].id})}}t=!0}}a(!!t)}})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),y=async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"sessionStorage":((e,n,a)=>{let r=Object.keys(sessionStorage);for(let e=0;e<r.length;e++)r[e].split("_").length>1||c({type:"item",key:r[e]});(e=>{t(e)})(!0)})();break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),u=async(e,t,...n)=>new Promise(async(t,n)=>{switch(e.type){case"plan":(async(e,n,a)=>{e.this.addEventListener("click",async e=>{let t=!0,n=e.target.parentNode;for(;t;)"TR"===n.tagName?t=!1:n=n.parentNode;switch(e.target.name){case"plan":let t=n.querySelector(".price");(t=t.querySelector("select")).selectedIndex=e.target.selectedIndex;break;case"price":let a=n.querySelector(".plan");(a=a.querySelector("select")).selectedIndex=e.target.selectedIndex}}),(e=>{t(e)})(!0)})(e);break;default:(e=>{n(e)})(`новая функция ${e.type} `)}}),g=(e,t)=>new Promise(async(n,a)=>{e.addEventListener("click",async e=>{let n=!0,a=e.target.parentNode;for(;n;)"TR"===a.tagName?n=!1:a=a.parentNode;a=parseInt(a.querySelector("td").innerText,10),confirm("Вы точно хотите удалить объект ?")&&fetch(`http://dev.work/api/item/${a}`,{method:"DELETE"}).then((function(e){return e.text()})).then((async function(e){t.querySelector("tbody").innerHTML="",t.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(t)}))}),(e=>{n(e)})(t)}),m=(e,t,...n)=>{const s=e=>new Promise((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>n(e)});function g(t){$("#maxRows").on("change",(function(){$(".pagination").html("");var n=0,a=parseInt($(this).val()),o=$(t+" tbody tr").length;if($(t+" tr:gt(0)").each((function(){++n>a&&$(this).hide(),n<=a&&$(this).show()})),o>a)for(var i=Math.ceil(o/a),l=1;l<=i;)$(".pagination").append('<li data-page="'+l+'">\t\t\t\t\t\t\t \t      <span>'+l+++'<span class="sr-only"></span></span>\t\t\t\t\t\t\t\t    </li>').show();$(".pagination li:first-child").addClass("active"),m(a,1,o),$(".pagination li").on("click",(async function(n){n.preventDefault();var i=$(this).attr("data-page"),l=0;$(".pagination li").removeClass("active"),$(this).addClass("active"),m(a,i,o),$(t+" tr:gt(0)").each((function(){++l>a*i||l<=a*i-a?$(this).hide():this.style.display=""})),e.querySelector(".btn-primary").addEventListener("click",async t=>{let n=await r(),a=!0,o=t.target;for(;a;)"MAIN-TABLE"===o.tagName?a=!1:o=o.parentNode;o.querySelector("#formConteiner").innerHTML="",o.querySelector("#formConteiner").insertAdjacentHTML("beforeend",n),sessionStorage.setItem("city",0),e.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)}),n=o.querySelector("#object-form");for(let e=0;e<n.querySelectorAll("input").length;e++)n.querySelectorAll("input")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});for(let e=0;e<n.querySelectorAll("textarea").length;e++)n.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});o.querySelector(".btn-success").addEventListener("click",async t=>{let n=new FormData;for(let e=0;e<o.querySelectorAll("input").length;e++)n.append(`${o.querySelectorAll("input")[e].name}`,sessionStorage.getItem(`${o.querySelectorAll("input")[e].name}`)),sessionStorage.removeItem(`${o.querySelectorAll("input")[e].name}`);for(let e=0;e<o.querySelectorAll("textarea").length;e++)n.append(`${o.querySelectorAll("textarea")[e].name}`,sessionStorage.getItem(`${o.querySelectorAll("textarea")[e].name}`)),sessionStorage.removeItem(`${o.querySelectorAll("textarea")[e].name}`);if(n.append("city",sessionStorage.getItem("city")),n.append("timestampUpdate",[]),void 0===o.querySelector("#file-upload").files[0])n.append("image","none"),n.append("fileUpload","none");else{let e=await s(o.querySelector("#file-upload").files[0]);o.querySelector("#file-upload").files[0]&&(n.append("image",e),n.append("fileUpload",e))}let a=Date.now();n.append("timestamp",a),fetch("http://dev.work/api/item/",{method:"POST",body:n}).then((function(e){return e.text()})).then((async function(t){console.log(t),e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(e)}))})})}))}))}function m(e,t,n){var a=e*t,r="Showing "+(e*t-e+parseFloat(1))+" to "+a+" of "+n+" entries";$(".rows_count").html(r)}g("#table-id"),$("#maxRows").trigger("change"),$((function(){})),document.querySelector("#search_input_id").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_id")).value.toLowerCase();let d=await o.get({type:"id",id:r}),m=await p({type:"sessionStorage",item:"id",length:r.length});if(e.querySelector("tbody").innerHTML="",m){let t=await l({type:"all"});if(e.querySelector("tbody").innerHTML="",void 0===d){for(let e in t)c({type:"item",key:t[e].id});$("#maxRows").trigger("change"),g("#table-id")}else for(let n in t){let r=!1;if(d.length>1){for(let r=0;r<d.length;r++)if(t[n].id===d[r].id){let t=await a(d[r]);i({type:"item",key:`${d[r].id}`,value:JSON.stringify(d[r])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}}else{if(d.id===t[n].id){r=!0;let t=await a(d);i({type:"item",key:`${d.id}`,value:JSON.stringify(d)}),e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n].id})}}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]});$("#maxRows").trigger("change"),g("#table-id")}else if(e.querySelector("tbody").innerHTML="",await y({type:"sessionStorage"}),void 0===d){d=await o.get({type:"getAll",self:o});for(let e=0;e<d.length;e++){await a(d[e])}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]});$("#maxRows").trigger("change"),g("#table-id")}else{if(await y({type:"sessionStorage"}),d.length>1)for(let t=0;t<d.length;t++){let n=await a(d[t]);i({type:"item",key:`${d[t].id}`,value:JSON.stringify(d[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}else{let t=await a(d);i({type:"item",key:`${d.id}`,value:JSON.stringify(d)}),e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]});$("#maxRows").trigger("change"),g("#table-id")}}),document.querySelector("#search_input_City").addEventListener("change",async t=>{let n,r,s=await o.get({type:"index",index:"city",filter:document.getElementById("search_input_City").value.toLowerCase()});n=document.getElementById("search_input_City").value.toLowerCase();let l=await p({type:"sessionStorage",item:"city",length:n.length});switch(n){case"1":n="москва",await d({type:"sessionStorage",key:"city",value:-10});break;case"2":n="санкт-петербург",await d({type:"sessionStorage",key:"city",value:-10});break;default:n="Все",await d({type:"sessionStorage",key:"city",value:-9})}if(e.querySelector("tbody").innerHTML="",l){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let o=0;o<s.length;o++)if(s[o].id===t[n]){r=!0;let t=await a(s[o]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}}else{await y({type:"sessionStorage"});for(let t=0;t<s.length;t++){let n=await a(s[t]);i({type:"item",key:`${s[t].id}`,value:JSON.stringify(s[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n),r=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<r.length;e++)await u({type:"plan",this:r[e]})}}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_Developer").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_Developer")).value.toLowerCase();let l=await o.get({type:"index",index:"name",filter:r}),d=await p({type:"sessionStorage",item:"name",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_Object").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_Object")).value.toLowerCase();let l=await o.get({type:"index",index:"object",filter:r,self:o}),d=await p({type:"sessionStorage",item:"object",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_Deadline").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_Deadline")).value.toLowerCase();let l=await o.get({type:"index",index:"dateExperiences",filter:r,self:o}),d=await p({type:"sessionStorage",item:"dateExperiences",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_houseClass").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_houseClass")).value.toLowerCase();let l=await o.get({type:"index",index:"class",filter:r}),d=await p({type:"sessionStorage",item:"class",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_houseType").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_houseType")).value.toLowerCase();let l=await o.get({type:"index",index:"type",filter:r,self:o}),d=await p({type:"sessionStorage",item:"type",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_Metro").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_Metro")).value.toLowerCase();let l=await o.get({type:"index",index:"metro",filter:r,self:o}),d=await p({type:"sessionStorage",item:"metro",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_geo").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_geo")).value.toLowerCase();let l=await o.get({type:"index",index:"geo",filter:r,self:o}),d=await p({type:"sessionStorage",item:"geo",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]});s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_plan").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_plan")).value.toLowerCase();let l=await o.get({type:"index",index:"plans",filter:r}),d=await p({type:"sessionStorage",item:"plans",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]});s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_price").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_price")).value.toLowerCase();let l=await o.get({type:"index",index:"price",filter:r,self:o}),d=await p({type:"sessionStorage",item:"price",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_Finish").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_Finish")).value.toLowerCase();let l=await o.get({type:"index",index:"finish",filter:r,self:o}),d=await p({type:"sessionStorage",item:"finish",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")}),document.querySelector("#search_input_AdditionalInfo").addEventListener("keyup",async t=>{let n,r,s;r=(n=document.getElementById("search_input_AdditionalInfo")).value.toLowerCase();let l=await o.get({type:"index",index:"description",filter:r,self:o}),d=await p({type:"sessionStorage",item:"description",length:r.length});if(e.querySelector("tbody").innerHTML="",d){let t=Object.keys(sessionStorage);for(let n=0;n<t.length;n++)if(t[n].split("_").length>1);else{let r=!1;for(let s=0;s<l.length;s++)if(l[s].id===t[n]){r=!0;let t=await a(l[s]);e.querySelector("tbody").insertAdjacentHTML("beforeend",t)}!1===r&&c({type:"item",key:t[n]})}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}else{await y({type:"sessionStorage"});for(let t=0;t<l.length;t++){let n=await a(l[t]);i({type:"item",key:`${l[t].id}`,value:JSON.stringify(l[t])}),e.querySelector("tbody").insertAdjacentHTML("beforeend",n)}s=e.querySelector("tbody").querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await u({type:"plan",this:s[e]})}$("#maxRows").trigger("change"),g("#table-id")})},f=e=>new Promise(async(t,n)=>{fetch("http://dev.work/api/item",{method:"GET"}).then((function(e){return e.json()})).then((async function(t){for(let n=0;n<t.length;n++){let r=await a(t[n]);e.querySelector("tbody").insertAdjacentHTML("beforeend",r)}let n=e.querySelectorAll(".delete"),s=e.querySelectorAll(".edit"),o=e.querySelectorAll(".search_input_plan");for(let t=0;t<n.length;t++)await g(n[t],e);for(let t=0;t<s.length;t++)s[t].addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"TR"===a.tagName?n=!1:a=a.parentNode;n=!0;let s=t.target.parentNode;for(;n;)"MAIN-TABLE"===s.tagName?n=!1:s=s.parentNode;s.querySelector(".btn-primary").style.display="none",a=a.querySelectorAll("td");let o={},i=0;for(let e=0;e<a.length-1;e++)if(0===e)o.id=a[e].innerText,sessionStorage.setItem("id",a[e].innerText);else switch(e){case 1:switch(a[e].innerText){case"Санкт-Петербург":sessionStorage.setItem("city",2),o.city=2;break;case"Москва":sessionStorage.setItem("city",1),o.city=1;break;default:sessionStorage.setItem("city",0),o.city=0}break;case 2:sessionStorage.setItem("name",a[e].innerText),o.name=a[e].innerText;break;case 3:sessionStorage.setItem("object",a[e].innerText),o.object=a[e].innerText;break;case 4:sessionStorage.setItem("dateExperiences",a[e].innerText),o.dateExperiences=a[e].innerText;break;case 5:sessionStorage.setItem("class",a[e].innerText),o.class=a[e].innerText;break;case 6:sessionStorage.setItem("type",a[e].innerText),o.type=a[e].innerText;break;case 7:sessionStorage.setItem("metro",a[e].innerText),o.metro=a[e].innerText;break;case 8:sessionStorage.setItem("geo",a[e].innerText),o.geo=a[e].innerText;break;case 9:let t="",n=a[e].querySelectorAll("option");for(let e=0;e<n.length;e++)t=0===e?`${n[e].value}`:`${t},${n[e].value}`;i=parseInt(a[e].querySelector("select").selectedIndex,10),sessionStorage.setItem("plans",t),o.plans=t;break;case 10:let r="",s=a[e].querySelectorAll("option");for(let e=0;e<s.length;e++)r=0===e?`${s[e].value}`:`${r},${s[e].value}`;sessionStorage.setItem("price",r),o.price=r;break;case 11:sessionStorage.setItem("finish",a[e].innerText),o.finish=a[e].innerText;break;case 12:sessionStorage.setItem("description",a[e].innerText),o.description=a[e].innerText;break;default:console.assert(!1,`новое свойство ${e}`,a[e])}let l=await r(o,{}[i]);document.querySelector("#formConteiner").innerHTML="",document.querySelector("#formConteiner").insertAdjacentHTML("beforeend",l),document.querySelector("#city").selectedIndex=sessionStorage.getItem("city"),document.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)});let c=document.querySelector("#object-form");for(let e=0;e<c.querySelectorAll("input").length;e++)c.querySelectorAll("input")[e].oninput=function(e){sessionStorage.setItem(`${e.target.name}`,e.target.value)};for(let e=0;e<c.querySelectorAll("textarea").length;e++)c.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});document.querySelector(".btn-success").addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"MAIN-TABLE"===a.tagName?n=!1:a=a.parentNode;if(a.querySelector(".btn-primary").style.display="flex","undefined"===t.target.parentNode.querySelector("#file-upload").files[0]||void 0===t.target.parentNode.querySelector("#file-upload").files[0]){let t=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),image:sessionStorage.getItem("fileUpload"),description:sessionStorage.getItem("description"),timestampUpdate:Date.now().toString()}),n=new XMLHttpRequest;n.withCredentials=!0,n.addEventListener("readystatechange",(async function(){4===this.readyState&&(e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(e))})),n.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("cache-control","no-cache"),n.send(t)}else{let n=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),description:sessionStorage.getItem("description"),image:await toBase64(t.target.parentNode.querySelector("#file-upload").files[0]),timestampUpdate:Date.now().toString()}),a=new XMLHttpRequest;a.withCredentials=!0,a.addEventListener("readystatechange",(async function(){4===this.readyState&&(e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(e))})),a.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("cache-control","no-cache"),a.send(n)}})});for(let e=0;e<o.length;e++)await u({type:"plan",this:o[e]});e.querySelector(".close").addEventListener("click",async e=>{let t=!0,n=e.target;for(;t;)"MAIN-TABLE"===n.tagName?t=!1:n=n.parentNode;n.querySelector("#formConteiner").innerHTML="",sessionStorage.clear()}),e.querySelector(".btn-primary").addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"MAIN-TABLE"===a.tagName?n=!1:a=a.parentNode;a.querySelector(".btn-primary").style.display="none";let s=t.target.parentNode.parentNode;n=!0;t.target.parentNode;let o=await r();s.querySelector("#formConteiner").innerHTML="",s.querySelector("#formConteiner").insertAdjacentHTML("beforeend",o),sessionStorage.setItem("city",0),e.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)}),o=s.querySelector("#object-form");for(let e=0;e<o.querySelectorAll("input").length;e++)o.querySelectorAll("input")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});for(let e=0;e<o.querySelectorAll("textarea").length;e++)o.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});s.querySelector(".btn-success").addEventListener("click",async t=>{let n=new FormData;for(let e=0;e<s.querySelectorAll("input").length;e++)n.append(`${s.querySelectorAll("input")[e].name}`,sessionStorage.getItem(`${s.querySelectorAll("input")[e].name}`)),sessionStorage.removeItem(`${s.querySelectorAll("input")[e].name}`);for(let e=0;e<s.querySelectorAll("textarea").length;e++)n.append(`${s.querySelectorAll("textarea")[e].name}`,sessionStorage.getItem(`${s.querySelectorAll("textarea")[e].name}`)),sessionStorage.removeItem(`${s.querySelectorAll("textarea")[e].name}`);n.append("city",sessionStorage.getItem("city")),n.append("timestampUpdate",[]);if(void 0===s.querySelector("#file-upload").files[0])n.append("image",[]);else{let e=await(e=>new Promise((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>n(e)}))(s.querySelector("#file-upload").files[0]);s.querySelector("#file-upload").files[0]&&n.append("image",e)}let a=Date.now();n.append("timestamp",a),fetch("http://dev.work/api/item/",{method:"POST",body:n}).then((function(e){return e.text()})).then((async function(t){console.log(t),e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(e)}))})}),m(e)}))}),h=e=>new Promise(async(t,n)=>{fetch("http://dev.work/api/item",{method:"GET"}).then((function(e){return e.json()})).then((async function(t){for(let n=0;n<t.length;n++){let r=await a(t[n]);e.querySelector("tbody").insertAdjacentHTML("beforeend",r)}let n=e.querySelectorAll(".delete"),s=e.querySelectorAll(".edit"),o=e.querySelectorAll(".search_input_plan");for(let t=0;t<n.length;t++)await g(n[t],e);for(let t=0;t<s.length;t++)s[t].addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"TR"===a.tagName?n=!1:a=a.parentNode;n=!0;let s=t.target.parentNode;for(;n;)"MAIN-TABLE"===s.tagName?n=!1:s=s.parentNode;s.querySelector(".btn-primary").style.display="none",a=a.querySelectorAll("td");let o={},i=0;for(let e=0;e<a.length-1;e++)if(0===e)o.id=a[e].innerText,sessionStorage.setItem("id",a[e].innerText);else switch(e){case 1:switch(a[e].innerText){case"Санкт-Петербург":sessionStorage.setItem("city",2),o.city=2;break;case"Москва":sessionStorage.setItem("city",1),o.city=1;break;default:sessionStorage.setItem("city",0),o.city=0}break;case 2:sessionStorage.setItem("name",a[e].innerText),o.name=a[e].innerText;break;case 3:sessionStorage.setItem("object",a[e].innerText),o.object=a[e].innerText;break;case 4:sessionStorage.setItem("dateExperiences",a[e].innerText),o.dateExperiences=a[e].innerText;break;case 5:sessionStorage.setItem("class",a[e].innerText),o.class=a[e].innerText;break;case 6:sessionStorage.setItem("type",a[e].innerText),o.type=a[e].innerText;break;case 7:sessionStorage.setItem("metro",a[e].innerText),o.metro=a[e].innerText;break;case 8:sessionStorage.setItem("geo",a[e].innerText),o.geo=a[e].innerText;break;case 9:let t="",n=a[e].querySelectorAll("option");for(let e=0;e<n.length;e++)t=0===e?`${n[e].value}`:`${t},${n[e].value}`;i=parseInt(a[e].querySelector("select").selectedIndex,10),sessionStorage.setItem("plans",t),o.plans=t;break;case 10:let r="",s=a[e].querySelectorAll("option");for(let e=0;e<s.length;e++)r=0===e?`${s[e].value}`:`${r},${s[e].value}`;sessionStorage.setItem("price",r),o.price=r;break;case 11:sessionStorage.setItem("finish",a[e].innerText),o.finish=a[e].innerText;break;case 12:sessionStorage.setItem("description",a[e].innerText),o.description=a[e].innerText;break;default:console.assert(!1,`новое свойство ${e}`,a[e])}let l=await r(o,{}[i]);document.querySelector("#formConteiner").innerHTML="",document.querySelector("#formConteiner").insertAdjacentHTML("beforeend",l),document.querySelector("#city").selectedIndex=sessionStorage.getItem("city"),document.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)});let c=document.querySelector("#object-form");for(let e=0;e<c.querySelectorAll("input").length;e++)c.querySelectorAll("input")[e].oninput=function(e){sessionStorage.setItem(`${e.target.name}`,e.target.value)};for(let e=0;e<c.querySelectorAll("textarea").length;e++)c.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});document.querySelector(".btn-success").addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"MAIN-TABLE"===a.tagName?n=!1:a=a.parentNode;if(a.querySelector(".btn-primary").style.display="flex","undefined"===t.target.parentNode.querySelector("#file-upload").files[0]||void 0===t.target.parentNode.querySelector("#file-upload").files[0]){let t=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),image:sessionStorage.getItem("fileUpload"),description:sessionStorage.getItem("description"),timestampUpdate:Date.now().toString()}),n=new XMLHttpRequest;n.withCredentials=!0,n.addEventListener("readystatechange",(async function(){4===this.readyState&&(e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await f(e))})),n.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("cache-control","no-cache"),n.send(t)}else{let n=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),description:sessionStorage.getItem("description"),image:await toBase64(t.target.parentNode.querySelector("#file-upload").files[0]),timestampUpdate:Date.now().toString()}),a=new XMLHttpRequest;a.withCredentials=!0,a.addEventListener("readystatechange",(async function(){4===this.readyState&&(e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await f(e))})),a.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("cache-control","no-cache"),a.send(n)}})});for(let e=0;e<o.length;e++)await u({type:"plan",this:o[e]});e.querySelector(".close").addEventListener("click",async e=>{let t=!0,n=e.target;for(;t;)"MAIN-TABLE"===n.tagName?t=!1:n=n.parentNode;n.querySelector("#formConteiner").innerHTML="",sessionStorage.clear()}),e.querySelector(".btn-primary").addEventListener("click",async t=>{let n=!0,a=t.target.parentNode;for(;n;)"MAIN-TABLE"===a.tagName?n=!1:a=a.parentNode;a.querySelector(".btn-primary").style.display="none",n=!0;let s=t.target;for(;n;)"MAIN-TABLE"===s.tagName?n=!1:s=s.parentNode;let o=await r();s.querySelector("#formConteiner").innerHTML="",s.querySelector("#formConteiner").insertAdjacentHTML("beforeend",o),sessionStorage.setItem("city",0),e.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)}),o=s.querySelector("#object-form");for(let e=0;e<o.querySelectorAll("input").length;e++)o.querySelectorAll("input")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});for(let e=0;e<o.querySelectorAll("textarea").length;e++)o.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});s.querySelector(".btn-success").addEventListener("click",async t=>{let n=new FormData;for(let e=0;e<object.querySelectorAll("input").length;e++)n.append(`${object.querySelectorAll("input")[e].name}`,sessionStorage.getItem(`${object.querySelectorAll("input")[e].name}`)),sessionStorage.removeItem(`${s.querySelectorAll("input")[e].name}`);for(let e=0;e<object.querySelectorAll("textarea").length;e++)n.append(`${object.querySelectorAll("textarea")[e].name}`,sessionStorage.getItem(`${object.querySelectorAll("textarea")[e].name}`)),sessionStorage.removeItem(`${s.querySelectorAll("textarea")[e].name}`);n.append("city",sessionStorage.getItem("city")),n.append("timestampUpdate",[]);if(void 0===object.querySelector("#file-upload").files[0])n.append("image",[]);else{let e=await(e=>new Promise((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>n(e)}))(object.querySelector("#file-upload").files[0]);s.querySelector("#file-upload").files[0]&&n.append("image",e)}let a=Date.now();n.append("timestamp",a),fetch("http://dev.work/api/item/",{method:"POST",body:n}).then((function(e){return e.text()})).then((async function(t){console.log(t),e.querySelector("tbody").innerHTML="",e.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await f(e)}))})}),m(e)}))});let S=[{city:[],search:""},{name:[],search:""},{object:[],search:""},{dateExperiences:[],search:""},{class:[],search:""},{type:[],search:""},{metro:[],search:""},{geo:[],search:""},{plans:[],search:""},{price:[],search:""},{finish:[],search:""},{description:[],search:""},{timestampUpdate:[],search:""}];for(let e in S)for(let t in S[e])switch(t){case"city":S[e][t].push({word:"москва",change:"москва"}),S[e][t].push({word:"санкт-петербург",change:"санкт-петербург"}),S[e][t].push({word:"подмосковье",change:"москва"});break;case"name":S[e][t].push({word:"Tokio группа",change:"Tekia Group"}),S[e][t].push({word:"Tokio группа",change:"Tekia Group"}),S[e][t].push({word:"таким грубым",change:"Tekia Group"}),S[e][t].push({word:"Так я группу",change:"Tekia Group"}),S[e][t].push({word:"роуз групп",change:"роуз групп"}),S[e][t].push({word:"кортрос",change:"кортрос"}),S[e][t].push({word:"Капитал гроуп",change:"Капитал гроуп"}),S[e][t].push({word:"вайнбридж",change:"вайнбридж"});break;case"object":S[e][t].push({word:"Биг Тайм",change:"Биг Тайм"}),S[e][t].push({word:"Спайрс",change:"Спайрс"}),S[e][t].push({word:"Микрогород в лесу",change:"Микрогород в лесу"}),S[e][t].push({word:"Big Time",change:"Big Time"}),S[e][t].push({word:"Прайс",change:"Спайрс"});break;case"dateExperiences":break;case"class":S[e][t].push({word:"обычный",change:"обычный"}),S[e][t].push({word:"обычно",change:"обычный"}),S[e][t].push({word:"элитный",change:"элитный"}),S[e][t].push({word:"элитно",change:"элитный"}),S[e][t].push({word:"комфорт",change:"комфорт"})}(async()=>{await o.set({type:"dictionary",data:S})})();let b=document.createElement("template");b.innerHTML='\n<style> @import "/js/module/main-table.css";</style>\n<speech-index></speech-index>\n<tags-index></tags-index>\n<div class="container-fluid">\n<div class="header_wrap">\n<div class="num_rows">\n</div>\n<div class="form-group"> \x3c!--Show Numbers Of Rows --\x3e\n <select class  ="form-control" name="state" id="maxRows">\n <option value="10">10</option>\n <option value="15">15</option>\n <option value="20">20</option>\n <option value="50">50</option>\n <option value="70">70</option>\n <option value="100">100</option>\n <option value="5000">Show ALL Rows</option>\n</select>\n</div>\n</div>\n<table cellspacing="2" border="1" cellpadding="5" align="center" class="table table-striped table-class" id= "table-id">\n<thead>\n<tr>\n<th style="width: 2%;"><input type="text"  class="col-md-12" id="search_input_id"  placeholder="id" class="form-control"></th>\n<th style="width: 7%;">\n<select class  ="form-control search_input_City" id="search_input_City" name="city">\n<option value="0">Все</option>\n<option value="1">Москва</option>\n<option value="2">Санкт-Петербург</option>\n</select>\n</th>\n<th style="width: 5.5%;"><input type="text" class="col-md-12"id="search_input_Developer"   placeholder="Застройщик" class="form-control"></th>\n<th style="width: 5.5%;"><input type="text" class="col-md-12"id="search_input_Object"   placeholder="Объект" class="form-control"></th>\n<th style="width: 5.5%;"><input type="text" class="col-md-12"id="search_input_Deadline"  placeholder="Срок сдачи" class="form-control"></th>\n<th style="width: 5.5%; "><input type="text" class="col-md-12" id="search_input_houseClass"  placeholder="Класс жилья" class="form-control"></th>\n<th style="width: 5.5%; "> <input type="text" class="col-md-12"id="search_input_houseType"  placeholder="Тип жилья" class="form-control"></th>\n<th style="width: 7%; "><input type="text" class="col-md-12"id="search_input_Metro"  placeholder="Метро" class="form-control"></th>\n<th style="width: 5.5%; "><input type="text" class="col-md-12"id="search_input_geo"  placeholder="ГЕО" class="form-control"></th>\n<th style="width: 5%; "><input type="text" class="col-md-12"id="search_input_plan"  placeholder="Планировки" class="form-control"></th>\n<th style="width: 12%; "><input type="text" class="col-md-12"id="search_input_price"  placeholder="Цена от" class="form-control"></th>\n<th style="width: 5.5%; "><input type="text" class="col-md-12"id="search_input_Finish"  placeholder="Отделака" class="form-control"></th>\n<th style="width: 15%;"><input type="text" class="col-md-12"id="search_input_AdditionalInfo"  placeholder="Дополнительная Информация" class="form-control"></th>\n<th style="width: 7%; "><input type="text" class="col-md-12"id="search_input_edit"  placeholder="" class="form-control"></th>\n</tr>\n  </thead>\n<tbody>\n\x3c!-- Here the items object --\x3e\n<tbody>\n</table>\n<div class=\'pagination-container\'>\n<nav>\n  <ul class="pagination">\n   \x3c!--Here the JS Function Will Add the Rows --\x3e\n  </ul>\n</nav> <div class="rows_count">Showing 11 to 20 of 91 entries</div></div>\n</div>\n<section id="addItem">\n<div class="hpanel">\n    <div class="panel-body">\n    <div id="menuItem">\n            <button type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">Создать</button>\n            <button type="button" class="btn btn-secondary close">Закрыть</button>\n    </div>\n      <div id="formConteiner"></div>\n    </div>\n</div>\n</section>\n';class w extends HTMLElement{static get observedAttributes(){return["disabled","open"]}get open(){return this.hasAttribute("open")}set open(e){e?this.setAttribute("open",""):this.removeAttribute("open"),this.toggleDrawer()}get disabled(){return this.hasAttribute("disabled")}set disabled(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}constructor(){super(),sessionStorage.clear(),this.addEventListener("click",e=>{this.disabled});let e=document.createElement("script");e.src="/js/module/speech-index.js",e.type="module",this.appendChild(b.content.cloneNode(!0)),this.appendChild(e)}connectedCallback(){const e=e=>new Promise((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>n(e)});let t=this;(async()=>{let n={};try{n=await o.get({type:"getAll"})}catch(e){}n=await fetch("http://dev.work/api/item",{method:"GET"}),n=await n.json();for(let e=0;e<n.length;e++)await o.put({type:"item",value:n[e]});for(let e=0;e<n.length;e++){let r=await a(n[e]);t.querySelector("tbody").insertAdjacentHTML("beforeend",r)}let s=t.querySelectorAll(".delete"),i=t.querySelectorAll(".edit"),l=t.querySelectorAll(".search_input_plan");for(let e=0;e<s.length;e++)await g(s[e],t);for(let n=0;n<i.length;n++)i[n].addEventListener("click",async n=>{let a=!0,s=n.target.parentNode;for(;a;)"TR"===s.tagName?a=!1:s=s.parentNode;a=!0;let o=s;for(;a;)"MAIN-TABLE"===o.tagName?a=!1:o=o.parentNode;o.querySelector(".close").addEventListener("click",async e=>{e.target.parentNode.parentNode.querySelector(".btn-primary").style.display="flex",e.target.parentNode.parentNode.querySelector("#formConteiner").innerHTML="",sessionStorage.clear()}),o.querySelector(".btn-primary").style.display="none",s=s.querySelectorAll("td");let i={},l=0;for(let e=0;e<s.length-1;e++)if(0===e)i.id=s[e].innerText,sessionStorage.setItem("id",s[e].innerText);else switch(e){case 1:switch(s[e].innerText){case"Санкт-Петербург":sessionStorage.setItem("city",2),i.city=2;break;case"Москва":sessionStorage.setItem("city",1),i.city=1;break;default:sessionStorage.setItem("city",0),i.city=0}break;case 2:sessionStorage.setItem("name",s[e].innerText),i.name=s[e].innerText;break;case 3:sessionStorage.setItem("object",s[e].innerText),i.object=s[e].innerText;break;case 4:sessionStorage.setItem("dateExperiences",s[e].innerText),i.dateExperiences=s[e].innerText;break;case 5:sessionStorage.setItem("class",s[e].innerText),i.class=s[e].innerText;break;case 6:sessionStorage.setItem("type",s[e].innerText),i.type=s[e].innerText;break;case 7:sessionStorage.setItem("metro",s[e].innerText),i.metro=s[e].innerText;break;case 8:sessionStorage.setItem("geo",s[e].innerText),i.geo=s[e].innerText;break;case 9:let t="",n=s[e].querySelectorAll("option");for(let e=0;e<n.length;e++)t=0===e?`${n[e].value}`:`${t},${n[e].value}`;l=parseInt(s[e].querySelector("select").selectedIndex,10),sessionStorage.setItem("plans",t),i.plans=t;break;case 10:let a="",r=s[e].querySelectorAll("option");for(let e=0;e<r.length;e++)a=0===e?`${r[e].value}`:`${a},${r[e].value}`;sessionStorage.setItem("price",a),i.price=a;break;case 11:sessionStorage.setItem("finish",s[e].innerText),i.finish=s[e].innerText;break;case 12:sessionStorage.setItem("description",s[e].innerText),i.description=s[e].innerText;break;default:console.assert(!1,`новое свойство ${e}`,s[e])}let c=await r(i,{}[l]);document.querySelector("#formConteiner").innerHTML="",document.querySelector("#formConteiner").insertAdjacentHTML("beforeend",c),document.querySelector("#city").selectedIndex=sessionStorage.getItem("city"),document.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)});let d=document.querySelector("#object-form");for(let e=0;e<d.querySelectorAll("input").length;e++)d.querySelectorAll("input")[e].oninput=function(e){sessionStorage.setItem(`${e.target.name}`,e.target.value)};for(let e=0;e<d.querySelectorAll("textarea").length;e++)d.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});document.querySelector(".btn-success").addEventListener("click",async n=>{let a=!0,r=n.target.parentNode;for(;a;)"MAIN-TABLE"===r.tagName?a=!1:r=r.parentNode;if(r.querySelector(".btn-primary").style.display="flex","undefined"===n.target.parentNode.querySelector("#file-upload").files[0]||void 0===n.target.parentNode.querySelector("#file-upload").files[0]){let e=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),image:sessionStorage.getItem("fileUpload"),description:sessionStorage.getItem("description"),timestampUpdate:Date.now().toString()}),n=new XMLHttpRequest;n.withCredentials=!0,n.addEventListener("readystatechange",(async function(){4===this.readyState&&(t.querySelector("tbody").innerHTML="",t.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(t))})),n.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("cache-control","no-cache"),n.send(e)}else{let a=JSON.stringify({city:sessionStorage.getItem("city"),name:sessionStorage.getItem("name"),object:sessionStorage.getItem("object"),dateExperiences:sessionStorage.getItem("dateExperiences"),class:sessionStorage.getItem("class"),type:sessionStorage.getItem("type"),metro:sessionStorage.getItem("metro"),geo:sessionStorage.getItem("geo"),plans:sessionStorage.getItem("plans"),price:sessionStorage.getItem("price"),finish:sessionStorage.getItem("finish"),description:sessionStorage.getItem("description"),image:await e(n.target.parentNode.querySelector("#file-upload").files[0]),timestampUpdate:Date.now().toString()}),r=new XMLHttpRequest;r.withCredentials=!0,r.addEventListener("readystatechange",(async function(){4===this.readyState&&(t.querySelector("tbody").innerHTML="",t.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(t))})),r.open("PUT",`http://dev.work/api/item/${sessionStorage.getItem("id")}`),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("cache-control","no-cache"),r.send(a)}})});for(let e=0;e<l.length;e++)l[e].addEventListener("click",async e=>{let t=!0,n=e.target.parentNode;for(;t;)"TR"===n.tagName?t=!1:n=n.parentNode;switch(e.target.name){case"plan":let t=n.querySelector(".price");(t=t.querySelector("select")).selectedIndex=e.target.selectedIndex;break;case"price":let a=n.querySelector(".plan");(a=a.querySelector("select")).selectedIndex=e.target.selectedIndex}});t.querySelector(".close").addEventListener("click",async e=>{e.target.parentNode.parentNode.querySelector(".btn-primary").style.display="flex",e.target.parentNode.parentNode.querySelector("#formConteiner").innerHTML="",sessionStorage.clear()}),t.querySelector(".btn-primary").addEventListener("click",async n=>{let a=!0,s=n.target.parentNode;for(;a;)"MAIN-TABLE"===s.tagName?a=!1:s=s.parentNode;s.querySelector(".btn-primary").style.display="none";let o=n.target.parentNode.parentNode;a=!0;n.target.parentNode;let i=await r();o.querySelector("#formConteiner").innerHTML="",o.querySelector("#formConteiner").insertAdjacentHTML("beforeend",i),sessionStorage.setItem("city",0),t.querySelector("#city").addEventListener("change",async e=>{sessionStorage.setItem("city",e.target.selectedIndex)}),i=o.querySelector("#object-form");for(let e=0;e<i.querySelectorAll("input").length;e++)i.querySelectorAll("input")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});for(let e=0;e<i.querySelectorAll("textarea").length;e++)i.querySelectorAll("textarea")[e].addEventListener("input",e=>{sessionStorage.setItem(`${e.target.name}`,e.target.value)});o.querySelector(".btn-success").addEventListener("click",async n=>{let a=new FormData;for(let e=0;e<o.querySelectorAll("input").length;e++)a.append(`${o.querySelectorAll("input")[e].name}`,sessionStorage.getItem(`${o.querySelectorAll("input")[e].name}`)),sessionStorage.removeItem(`${o.querySelectorAll("input")[e].name}`);for(let e=0;e<o.querySelectorAll("textarea").length;e++)a.append(`${o.querySelectorAll("textarea")[e].name}`,sessionStorage.getItem(`${o.querySelectorAll("textarea")[e].name}`)),sessionStorage.removeItem(`${o.querySelectorAll("textarea")[e].name}`);if(a.append("city",sessionStorage.getItem("city")),a.append("timestampUpdate",[]),void 0===o.querySelector("#file-upload").files[0])a.append("image",[]);else{let t=await e(o.querySelector("#file-upload").files[0]);o.querySelector("#file-upload").files[0]&&a.append("image",t)}let r=Date.now();a.append("timestamp",r),fetch("http://dev.work/api/item/",{method:"POST",body:a}).then((function(e){return e.text()})).then((async function(e){console.log(e),t.querySelector("tbody").innerHTML="",t.querySelector("#formConteiner").innerHTML="",sessionStorage.clear(),await h(t)}))})}),m(t,{pagination:m})})()}disconnectedCallback(){}componentWillMount(){}componentDidMount(){}componentWillUnmount(){}componentDidUnmount(){}toggleDrawer(){}attributeChangedCallback(e,t,n){}}window.customElements.define("main-table",w)}]);